"use strict";(self.webpackChunkdungeon_tools=self.webpackChunkdungeon_tools||[]).push([[589],{1589:(Ye,E,s)=>{s.r(E),s.d(E,{NotesModule:()=>Je});var a=s(6895),d=s(4006),m=s(4269),I=s(8314),Z=s(1684),G=s(5190),A=s(5092),D=s(6051),P=s(7395),p=s(5412),e=s(4650);let F=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[a.ez,p.Is,d.UX]}),n})(),J=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[a.ez,I.p,Z._,p.Is]}),n})();var C=s(727),_=s(7579),h=s(3900),Y=s(9841),L=s(4482);const{isArray:U}=Array;function j(n){return 1===n.length&&U(n[0])?n[0]:n}var Q=s(3268),q=s(9635),R=s(3269);function w(...n){const r=(0,R.jO)(n);return r?(0,q.z)(w(...n),(0,Q.Z)(r)):(0,L.e)((t,o)=>{(0,Y.l)([t,...j(n)])(o)})}function T(...n){return w(...n)}var y=s(9646),f=s(1848),B=s(5698),K=s(9791),g=s(1704),M=s(6209),V=s(8184),z=s(266),O=s(7392),N=s(4454);function W(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"lxs-action",11),e.NdJ("action",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onClickBack())}),e.qZA()}}function X(n,r){if(1&n&&(e.TgZ(0,"strong"),e.GkF(1,12),e.qZA()),2&n){e.oxw();const t=e.MAs(7);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function $(n,r){if(1&n&&e._uU(0),2&n){const t=e.oxw();e.Oqu(t.data.rootLabel)}}function ee(n,r){if(1&n&&(e.TgZ(0,"strong"),e.GkF(1,12),e.qZA()),2&n){e.oxw();const t=e.MAs(4);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function te(n,r){if(1&n&&e._uU(0),2&n){const t=e.oxw().$implicit;e.Oqu(t)}}function ne(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1," > "),e.YNc(2,ee,2,1,"strong",3),e.YNc(3,te,1,1,"ng-template",null,13,e.W1O),e.qZA()),2&n){const t=r.index,o=e.MAs(4),i=e.oxw();e.xp6(2),e.Q6J("ngIf",t===i.currentHierarchyNames.length-1)("ngIfElse",o)}}function oe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",14),e.NdJ("click",function(){const c=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onClickGroup(c))}),e.TgZ(1,"span",15),e._uU(2),e.qZA(),e._UZ(3,"mat-icon",16),e.qZA()}if(2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.name)}}function ie(n,r){1&n&&(e.TgZ(0,"div",17),e._uU(1,"No groups"),e.qZA())}let re=(()=>{class n{constructor(t,o){this.dialog=t,this.data=o,this.currentTree=[],this.currentHierarchyNames=[],this.currentHierarchy=o.currentHierarchy,this.rebuildTree()}rebuildTree(){let o,t=this.data.tree;const i=[],c=[];for(const l of this.currentHierarchy){const u=t.find(k=>k.id===l&&k.isGroup);if(!u||!u.isGroup)break;o=u,t=u.children,i.push(l),c.push(u.name)}this.currentTree=t.filter(g.LE),this.currentGroup=o,this.currentHierarchy=i,this.currentHierarchyNames=c}onClickGroup(t){this.currentHierarchy=[...this.currentHierarchy,t.id],this.rebuildTree()}onClickBack(){this.currentHierarchy=this.currentHierarchy.slice(0,-1),this.rebuildTree()}onClickCancel(){this.dialog.close(void 0)}onClickSubmit(){this.dialog.close(this.areEqual(this.currentHierarchy,this.data.currentHierarchy.slice(0,-1))?void 0:this.currentHierarchy)}areEqual(t,o){if(t.length!==o.length)return!1;for(const[i,c]of t.entries())if(c!==o[i])return!1;return!0}trackById(t,o){return o.id}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.so),e.Y36(p.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["lxs-tree-dialog"]],features:[e._Bn([{provide:z.cV,deps:[V.aV],useFactory:r=>()=>r.scrollStrategies.close()}])],decls:17,vars:8,consts:[[1,"title"],[1,"current-path"],["icon","back","label","Up","display","smallIconButton",3,"action",4,"ngIf"],[4,"ngIf","ngIfElse"],["rootLabel",""],[4,"ngFor","ngForOf"],[1,"tree-list"],["class","tree-group",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["class","tree-group",4,"ngIf"],[1,"buttons"],[1,"button",3,"click"],["icon","back","label","Up","display","smallIconButton",3,"action"],[3,"ngTemplateOutlet"],["nameLabel",""],[1,"tree-group",3,"click"],[1,"name"],["svgIcon","forward",1,"icon"],[1,"tree-group"]],template:function(t,o){if(1&t&&(e.TgZ(0,"h3",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1),e.YNc(3,W,1,0,"lxs-action",2),e.TgZ(4,"span"),e.YNc(5,X,2,1,"strong",3),e.YNc(6,$,1,1,"ng-template",null,4,e.W1O),e.qZA(),e.YNc(8,ne,5,2,"span",5),e.qZA(),e.TgZ(9,"div",6),e.YNc(10,oe,4,1,"div",7),e.YNc(11,ie,2,0,"div",8),e.qZA(),e.TgZ(12,"div",9)(13,"div",10),e.NdJ("click",function(){return o.onClickCancel()}),e._uU(14," Cancel "),e.qZA(),e.TgZ(15,"div",10),e.NdJ("click",function(){return o.onClickSubmit()}),e._uU(16," Move Here "),e.qZA()()),2&t){const i=e.MAs(7);e.xp6(1),e.Oqu(o.data.message),e.xp6(2),e.Q6J("ngIf",o.currentHierarchyNames.length>0),e.xp6(2),e.Q6J("ngIf",0===o.currentHierarchyNames.length)("ngIfElse",i),e.xp6(3),e.Q6J("ngForOf",o.currentHierarchyNames),e.xp6(2),e.Q6J("ngForOf",o.currentTree)("ngForTrackBy",o.trackById),e.xp6(1),e.Q6J("ngIf",0===o.currentTree.length)}},dependencies:[a.sg,a.O5,a.tP,O.Hw,N.N],styles:["[_nghost-%COMP%]{display:block;width:14rem}.title[_ngcontent-%COMP%]{text-align:center}.current-path[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;align-items:center;gap:.25rem;margin-bottom:.5rem}.current-path[_ngcontent-%COMP%]   .active-path[_ngcontent-%COMP%]{font-weight:600}.tree-list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){border-top:.0625rem solid #333}.tree-group[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:center;padding:1rem;-webkit-user-select:none;user-select:none}.tree-group[_ngcontent-%COMP%]:hover{cursor:pointer;color:#555}.tree-group[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:auto}.tree-group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{flex:none;width:1rem;height:1rem;line-height:1rem}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.button[_ngcontent-%COMP%]{padding:1rem;-webkit-user-select:none;user-select:none;color:#333}.button[_ngcontent-%COMP%]:hover{cursor:pointer;color:#555}"]}),n})(),se=(()=>{class n{constructor(t){this.dialog=t}open(t){return this.dialog.open(re,{data:t}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var b=s(9639),S=s(6094),ce=s(472),le=s(1135),ae=s(9300),de=s(5549),ue=s(8810);let pe=(()=>{class n{constructor(t,o,i,c){this.router=t,this.linker=o,this.notes=i,this.settings=c,this.noteId=new le.X(null),this.selectedInvalidLink=new _.x,this.subscriptions=new C.w0}ngOnChanges(t){t.id&&this.noteId.next(t.id.currentValue)}ngOnInit(){this.subscriptions.add(this.noteId.pipe((0,ae.h)(t=>!!t),(0,h.w)(t=>this.notes.getCurrentNoteValue(t))).subscribe(t=>{this.noteValue=t})),this.subscriptions.add(this.selectedInvalidLink.subscribe(t=>{const o=this.notes.addNoteEntry([],t);this.settings.setSetting("notesSelectedId",o),this.router.navigate(["notes",o])}))}ngOnDestroy(){this.subscriptions.unsubscribe()}onNoteChanged(t){const o=this.noteId.value;o&&this.notes.updateNoteValue(o,t)}onSelectedInvalidLink(t){this.selectedInvalidLink.next(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.F0),e.Y36(de.I),e.Y36(S.U),e.Y36(b.g))},n.\u0275cmp=e.Xpm({type:n,selectors:[["lxs-note-editor"]],inputs:{id:"id"},features:[e.TTD],decls:1,vars:2,consts:[["linkPreferredSource","notes",3,"value","linkEvaluator","valueChanged","selectedInvalidLink"]],template:function(t,o){1&t&&(e.TgZ(0,"lxs-inscription-editor",0),e.NdJ("valueChanged",function(c){return o.onNoteChanged(c)})("selectedInvalidLink",function(c){return o.onSelectedInvalidLink(c)}),e.qZA()),2&t&&e.Q6J("value",o.noteValue)("linkEvaluator",o.linker)},dependencies:[ue.p],styles:["[_nghost-%COMP%]{display:block}"]}),n})(),he=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["lxs-notes-help"]],decls:10,vars:0,template:function(t,o){1&t&&(e.TgZ(0,"h1"),e._uU(1,"Notes Tool"),e.qZA(),e.TgZ(2,"p"),e._uU(3," Use the Notes Tool to write wiki-style notes for anything!\n"),e.qZA(),e.TgZ(4,"p"),e._uU(5," Click the plus button on the left bar to add a new note, and select notes in the list below to swap between a currently viewed note. On a note editor, select the editing button above the note to rename the note, and select the editing button on the note card to toggle between editing and viewing the note.\n"),e.qZA(),e.TgZ(6,"p"),e._uU(7,' Notes support adding links to other notes. To link to another note, surround a note\'s name in square brackets []s. The link will match the first note with the same letters and numbers, regardless of letter case, spaces, or any other symbols in the name. For example, [a-note] would link to a note named "A Note", "Ano Te", "anotE+++", or any similar name. If a note does not exist that matches the link, clicking on the link will automatically create a new note with that name.\n'),e.qZA(),e.TgZ(8,"p"),e._uU(9," Open this page again by the question mark button on the left bar.\n"),e.qZA())}}),n})(),ge=(()=>{class n{constructor(t,o){this.dialog=t,this.data=o,this.renamingControl=new d.NI(""),this.renamingControl.setValue(this.data.currentValue)}onClickCancel(){this.dialog.close(void 0)}onClickSubmit(){this.dialog.close(this.renamingControl.value)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.so),e.Y36(p.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["lxs-text-field-dialog"]],decls:9,vars:2,consts:[[1,"title"],["type","text",3,"formControl"],[1,"buttons"],[1,"button",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"label")(1,"h3",0),e._uU(2),e.qZA(),e._UZ(3,"input",1),e.qZA(),e.TgZ(4,"div",2)(5,"div",3),e.NdJ("click",function(){return o.onClickCancel()}),e._uU(6," Cancel "),e.qZA(),e.TgZ(7,"div",3),e.NdJ("click",function(){return o.onClickSubmit()}),e._uU(8," Submit "),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(o.data.message),e.xp6(1),e.Q6J("formControl",o.renamingControl))},dependencies:[d.Fj,d.JJ,d.oH],styles:["[_nghost-%COMP%]{display:block;width:14rem}.title[_ngcontent-%COMP%]{text-align:center}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.button[_ngcontent-%COMP%]{padding:1rem;-webkit-user-select:none;user-select:none;color:#333}.button[_ngcontent-%COMP%]:hover{cursor:pointer;color:#555}"]}),n})(),me=(()=>{class n{constructor(t){this.dialog=t}open(t){return this.dialog.open(ge,{data:t}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var v=s(1206),_e=s(93),x=s(3839);function fe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"lxs-action",10),e.NdJ("action",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.helpEvent.emit())}),e.qZA()}}function ve(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"lxs-action",11),e.NdJ("action",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onBack())}),e.qZA()}}function xe(n,r){if(1&n&&e._uU(0),2&n){const t=e.oxw();e.hij(" ",t.currentGroup?t.currentGroup.name:t.label," ")}}function Ce(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"lxs-action",12),e.NdJ("action",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onClickShowGroupToolbar(!0))}),e.qZA()}}function Te(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"lxs-action",13),e.NdJ("action",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onClickShowGroupToolbar(!1))}),e.qZA()}}function ye(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"lxs-action",14),e.NdJ("action",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.deleteGroupEvent.emit(i.currentGroup))}),e.qZA()}}function Ne(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"lxs-action",15),e.NdJ("action",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.renameGroupEvent.emit(i.currentGroup))}),e.qZA()}}function be(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"lxs-action",16),e.NdJ("action",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addEvent.emit({type:"group",hierarchy:i.currentHierarchy}))}),e.qZA()}}function Se(n,r){1&n&&(e.TgZ(0,"div",29),e._UZ(1,"mat-icon",30),e.qZA())}function Ee(n,r){if(1&n&&(e.TgZ(0,"div",31),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.children.length?t.children.length+" Item"+(1===t.children.length?"":"s"):"Empty"," ")}}function Ie(n,r){if(1&n&&(e.TgZ(0,"div",32),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Ze(n,r){1&n&&e._UZ(0,"div",33)}const we=function(n){return{"side-item-active":n}};function Me(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(){const c=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.onSelect(c))}),e.TgZ(1,"div",21)(2,"div",22),e._UZ(3,"mat-icon",23),e.qZA(),e.TgZ(4,"div",24),e._uU(5),e.qZA(),e.YNc(6,Se,2,0,"div",25),e.YNc(7,Ee,2,1,"div",26),e.qZA(),e.YNc(8,Ie,2,1,"div",27),e.YNc(9,Ze,1,0,"div",28),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(2);e.Q6J("ngClass",e.VKq(4,we,t.id===o.currentSelectionId)),e.xp6(5),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",!t.isGroup),e.xp6(1),e.Q6J("ngIf",t.isGroup)}}function Oe(n,r){if(1&n&&(e.TgZ(0,"div",34),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" No ",t.label," ")}}function He(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",17),e.NdJ("cdkDropListDropped",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.onDrag(i))}),e.YNc(1,Me,10,6,"div",18),e.YNc(2,Oe,2,1,"div",19),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.currentTree)("ngForTrackBy",t.trackById),e.xp6(1),e.Q6J("ngIf",0===t.currentTree.length)}}let ke=(()=>{class n{constructor(){this.addEvent=new e.vpe,this.helpEvent=new e.vpe,this.selectEvent=new e.vpe,this.moveEvent=new e.vpe,this.renameGroupEvent=new e.vpe,this.deleteGroupEvent=new e.vpe,this.showGroupToolbar=!1,this.currentHierarchy=[]}ngOnChanges(t){t.tree&&this.rebuildTree(),t.selectedEntryId&&this.redirectSelection()}onBack(){this.tree?(this.currentHierarchy=this.currentHierarchy.slice(0,-1),this.currentGroup=(0,g.YW)(this.tree,this.currentHierarchy),this.currentTree=this.currentGroup?this.currentGroup.children:this.tree,this.reassignSeletion()):this.revertProperties()}onClickShowGroupToolbar(t){this.showGroupToolbar=t}onSelect(t){t.isGroup?(this.currentHierarchy=[...this.currentHierarchy,t.id],this.currentGroup=t,this.currentTree=t.children,this.reassignSeletion()):this.selectEvent.emit(t.id)}onDrag(t){t.previousIndex!==t.currentIndex&&this.moveEvent.emit({hierarchy:this.currentHierarchy,from:t.previousIndex,to:t.currentIndex})}revertProperties(){this.currentTree=void 0,this.currentGroup=void 0,this.currentHierarchy=[]}rebuildTree(){if(!this.tree)return void this.revertProperties();let o,t=this.tree;const i=[];for(const c of this.currentHierarchy){const l=t.find(u=>u.id===c&&u.isGroup);if(!l||!l.isGroup)break;o=l,t=l.children,i.push(c)}this.currentTree=t,this.currentGroup=o,this.currentHierarchy=i,this.reassignSeletion()}reassignSeletion(){if(!this.tree||!this.selectedEntryId)return void(this.currentSelectionId=void 0);const t=(0,g.Hm)(this.tree,o=>o.id===this.selectedEntryId);if(t)for(const[o,i]of t.entries()){if(!(o<this.currentHierarchy.length))return void(this.currentSelectionId=i);if(this.currentHierarchy[o]!==i)return void(this.currentSelectionId=void 0)}else this.currentSelectionId=void 0}redirectSelection(){if(!this.tree||!this.selectedEntryId)return;const t=(0,g.Hm)(this.tree,o=>o.id===this.selectedEntryId);!t||(this.currentHierarchy=t.slice(0,-1),this.currentGroup=(0,g.YW)(this.tree,this.currentHierarchy),this.currentTree=this.currentGroup?.children||this.tree,this.reassignSeletion())}trackById(t,o){return o.id}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["lxs-side-tree"]],inputs:{label:"label",tree:"tree",selectedEntryId:"selectedEntryId",showHelp:"showHelp"},outputs:{addEvent:"addEvent",helpEvent:"helpEvent",selectEvent:"selectEvent",moveEvent:"moveEvent",renameGroupEvent:"renameGroupEvent",deleteGroupEvent:"deleteGroupEvent"},features:[e.TTD],decls:11,vars:8,consts:[["lxsSideHeaderLeft","","icon","question","label","Help",3,"action",4,"ngIf"],["lxsSideHeaderLeft","","icon","back","label","Back",3,"action",4,"ngIf"],["lxsSideHeaderLabel",""],["lxsSideHeaderRight","","icon","add","label","Add",3,"action"],["lxsSideHeaderRight","","icon","expand","label","Show Group Toolbar",3,"action",4,"ngIf"],["lxsSideHeaderRight","","icon","collapse","label","Hide Group Toolbar",3,"action",4,"ngIf"],["lxsSideHeaderToolbar","","icon","delete","label","Delete Group",3,"action",4,"ngIf"],["lxsSideHeaderToolbar","","icon","quill","label","Rename Group",3,"action",4,"ngIf"],["lxsSideHeaderToolbar","","icon","add","label","Add Group",3,"action",4,"ngIf"],["class","side-tree","cdkDropList","",3,"cdkDropListDropped",4,"ngIf"],["lxsSideHeaderLeft","","icon","question","label","Help",3,"action"],["lxsSideHeaderLeft","","icon","back","label","Back",3,"action"],["lxsSideHeaderRight","","icon","expand","label","Show Group Toolbar",3,"action"],["lxsSideHeaderRight","","icon","collapse","label","Hide Group Toolbar",3,"action"],["lxsSideHeaderToolbar","","icon","delete","label","Delete Group",3,"action"],["lxsSideHeaderToolbar","","icon","quill","label","Rename Group",3,"action"],["lxsSideHeaderToolbar","","icon","add","label","Add Group",3,"action"],["cdkDropList","",1,"side-tree",3,"cdkDropListDropped"],["class","side-item","cdkDrag","","cdkDragLockAxis","y",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","side-no-content",4,"ngIf"],["cdkDrag","","cdkDragLockAxis","y",1,"side-item",3,"ngClass","click"],[1,"side-item-content"],["cdkDragHandle","",1,"side-item-mover-button"],["svgIcon","handle"],[1,"side-item-label"],["class","side-entry-selector",4,"ngIf"],["class","side-group-count",4,"ngIf"],["class","side-item-drag-preview",4,"cdkDragPreview"],["class","side-item-drag-placeholder",4,"cdkDragPlaceholder"],[1,"side-entry-selector"],["svgIcon","forward"],[1,"side-group-count"],[1,"side-item-drag-preview"],[1,"side-item-drag-placeholder"],[1,"side-no-content"]],template:function(t,o){1&t&&(e.TgZ(0,"lxs-side-header"),e.YNc(1,fe,1,0,"lxs-action",0),e.YNc(2,ve,1,0,"lxs-action",1),e.YNc(3,xe,1,1,"ng-template",2),e.TgZ(4,"lxs-action",3),e.NdJ("action",function(){return o.addEvent.emit({type:"entry",hierarchy:o.currentHierarchy})}),e.qZA(),e.YNc(5,Ce,1,0,"lxs-action",4),e.YNc(6,Te,1,0,"lxs-action",5),e.YNc(7,ye,1,0,"lxs-action",6),e.YNc(8,Ne,1,0,"lxs-action",7),e.YNc(9,be,1,0,"lxs-action",8),e.qZA(),e.YNc(10,He,3,3,"div",9)),2&t&&(e.xp6(1),e.Q6J("ngIf",0===o.currentHierarchy.length&&o.showHelp),e.xp6(1),e.Q6J("ngIf",o.currentHierarchy.length>0),e.xp6(3),e.Q6J("ngIf",!o.showGroupToolbar),e.xp6(1),e.Q6J("ngIf",o.showGroupToolbar),e.xp6(1),e.Q6J("ngIf",o.showGroupToolbar&&o.currentGroup),e.xp6(1),e.Q6J("ngIf",o.showGroupToolbar&&o.currentGroup),e.xp6(1),e.Q6J("ngIf",o.showGroupToolbar),e.xp6(1),e.Q6J("ngIf",o.currentTree))},dependencies:[a.mk,a.sg,a.O5,v.Wj,v.Zt,v.Bh,v.pV,v.Hk,O.Hw,N.N,_e.z,x.iz,x.hA,x.wi,x.g2],styles:[".side-item[_ngcontent-%COMP%]{padding:0 .5rem;height:3rem;color:#333}.side-item[_ngcontent-%COMP%]:hover{background-color:#ddd;cursor:pointer}.side-item-active[_ngcontent-%COMP%], .side-item-active[_ngcontent-%COMP%]:hover{background-color:#444;color:#f2f2f2}.side-item-active[_ngcontent-%COMP%]   .side-item-mover-button[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{color:#f2f2f2}.side-item-active[_ngcontent-%COMP%]   .side-item-mover-button[_ngcontent-%COMP%]:hover > mat-icon[_ngcontent-%COMP%]{color:#aaa}.side-item-active[_ngcontent-%COMP%]   .side-entry-selector[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{color:#f2f2f2}.side-item-content[_ngcontent-%COMP%]{display:flex;flex-flow:row;justify-content:center;align-items:center;border-bottom:.0625rem solid #777;height:calc(100% - .0625rem)}.side-item-mover-button[_ngcontent-%COMP%]{margin-right:.5rem;display:flex;justify-content:center;align-items:center;width:2rem;height:2rem;line-height:2rem;-webkit-user-select:none;user-select:none}.side-item-mover-button[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{width:1rem;height:1rem;line-height:1rem;color:#333}.side-item-mover-button[_ngcontent-%COMP%]:hover{cursor:pointer}.side-item-mover-button[_ngcontent-%COMP%]:hover > mat-icon[_ngcontent-%COMP%]{color:#555}.side-item-label[_ngcontent-%COMP%]{flex:1}.side-item-drag-preview[_ngcontent-%COMP%]{margin:1rem;padding:1rem;background-color:#f7f7f7;color:#333;box-shadow:0 0 .5rem #44444460;width:12rem}.side-item-drag-placeholder[_ngcontent-%COMP%]{height:3rem;background-color:#44444460}.side-entry-selector[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.side-entry-selector[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{width:1rem;height:1rem;line-height:1rem;color:#333}.side-group-count[_ngcontent-%COMP%]{font-size:11px}.side-no-content[_ngcontent-%COMP%]{height:3rem;line-height:3rem;text-align:center;color:#333}"]}),n})(),Ge=(()=>{class n{constructor(t,o,i,c,l){this.router=t,this.confirmDialog=o,this.textFieldDialog=i,this.settings=c,this.notes=l,this.subscriptions=new C.w0,this.renameGroupSubject=new _.x,this.deleteGroupSubject=new _.x}ngOnInit(){this.subscriptions.add(this.notes.noteStore.subscribe(t=>{this.noteStore=t})),this.subscriptions.add(this.renameGroupSubject.pipe((0,h.w)(t=>(0,y.of)(t.id).pipe(T(this.textFieldDialog.open({message:"Rename Group:",currentValue:t.name}))))).subscribe(([t,o])=>{void 0!==o&&this.notes.editNoteGroup(t,i=>({...i,name:o}))})),this.subscriptions.add(this.deleteGroupSubject.pipe((0,h.w)(t=>(0,y.of)(t.id).pipe(T(this.confirmDialog.open({message:"Are you sure you want to delete this group? All entries will be added to the end of the parent."}))))).subscribe(([t,o])=>{o&&this.notes.deleteNoteGroup(t)}))}ngOnDestroy(){this.subscriptions.unsubscribe()}onClickAddNoteEntry(t){if("entry"===t.type){const o=this.notes.addNoteEntry(t.hierarchy);this.settings.setSetting("notesSelectedId",o),this.router.navigate(["notes",o])}else this.notes.addNoteGroup(t.hierarchy)}onClickAboutNotes(){this.settings.setSetting("notesSelectedId",null),this.router.navigate(["notes"])}onClickNoteEntry(t){t!==this.activeNoteEntryId&&(this.settings.setSetting("notesSelectedId",t),this.router.navigate(["notes",t]))}onClickMoveNoteEntry(t){this.notes.moveNoteEntry(t.hierarchy,t.from,t.to)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.F0),e.Y36(M.D),e.Y36(me),e.Y36(b.g),e.Y36(S.U))},n.\u0275cmp=e.Xpm({type:n,selectors:[["lxs-notes-list"]],inputs:{activeNoteEntryId:"activeNoteEntryId"},decls:1,vars:3,consts:[["side","","label","Notes",3,"tree","selectedEntryId","showHelp","addEvent","selectEvent","moveEvent","helpEvent","renameGroupEvent","deleteGroupEvent"]],template:function(t,o){1&t&&(e.TgZ(0,"lxs-side-tree",0),e.NdJ("addEvent",function(c){return o.onClickAddNoteEntry(c)})("selectEvent",function(c){return o.onClickNoteEntry(c)})("moveEvent",function(c){return o.onClickMoveNoteEntry(c)})("helpEvent",function(){return o.onClickAboutNotes()})("renameGroupEvent",function(c){return o.renameGroupSubject.next(c)})("deleteGroupEvent",function(c){return o.deleteGroupSubject.next(c)}),e.qZA()),2&t&&e.Q6J("tree",o.noteStore)("selectedEntryId",o.activeNoteEntryId)("showHelp",!0)},dependencies:[ke]}),n})();function Ae(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"label"),e._uU(2," Rename: "),e._UZ(3,"input",7),e.qZA(),e.TgZ(4,"lxs-action",8),e.NdJ("action",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onClickRenameCancel())}),e.qZA(),e.TgZ(5,"lxs-action",9),e.NdJ("action",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onClickRenameSave())}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("formControl",t.renamingControl)}}function De(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.TgZ(2,"lxs-action",10),e.NdJ("action",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.moveNoteSubject.next())}),e.qZA(),e.TgZ(3,"lxs-action",11),e.NdJ("action",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onClickRename())}),e.qZA(),e.TgZ(4,"lxs-action",12),e.NdJ("action",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.deleteNoteSubject.next())}),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.activeNoteEntryName)}}function Pe(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",3),e.YNc(2,Ae,6,1,"ng-container",1),e.YNc(3,De,5,1,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(5,"div",5),e._UZ(6,"lxs-note-editor",6),e.qZA(),e.BQk()),2&n){const t=e.MAs(4),o=e.oxw();e.xp6(2),e.Q6J("ngIf",o.isRenaming)("ngIfElse",t),e.xp6(4),e.Q6J("id",o.activeNoteEntryId)}}function Fe(n,r){1&n&&e._UZ(0,"lxs-notes-help")}let H=(()=>{class n{constructor(t,o,i,c,l,u){this.route=t,this.router=o,this.confirmDialog=i,this.treeDialog=c,this.settings=l,this.notes=u,this.subscriptions=new C.w0,this.isRenaming=!1,this.renamingControl=new d.NI("",{nonNullable:!0}),this.isDeleting=!1,this.moveNoteSubject=new _.x,this.deleteNoteSubject=new _.x}ngOnInit(){this.subscriptions.add(this.route.paramMap.pipe((0,h.w)(t=>{const o=t.get("id");return this.activeNoteEntryId=o??void 0,o&&"help"!==o?this.notes.getNoteEntry(o).pipe(T((0,y.of)(o))):"help"===o?(this.settings.setSetting("notesSelectedId",null),this.router.navigate(["notes"]),f.C):this.redirectToRecent()})).subscribe(([t,o])=>{t?(this.activeNoteEntryName=t.name,this.isRenaming||this.renamingControl.setValue(t.name)):this.isDeleting?(this.isDeleting=!1,this.router.navigate(["notes"])):this.router.navigate(["notes-not-found",o])})),this.subscriptions.add(this.moveNoteSubject.pipe((0,h.w)(()=>this.notes.noteStore.pipe((0,B.q)(1))),(0,h.w)(t=>{if(!this.activeNoteEntryId)return f.C;const o=(0,g.Hm)(t,(0,K.L)(this.activeNoteEntryId));return o?this.treeDialog.open({message:"Select Destination:",tree:t,currentHierarchy:o,rootLabel:"Notes"}):f.C})).subscribe(t=>{this.activeNoteEntryId&&t&&this.notes.moveNoteEntryToHierarchy(this.activeNoteEntryId,t)})),this.subscriptions.add(this.deleteNoteSubject.pipe((0,h.w)(()=>this.confirmDialog.open({message:"Are you sure you want to delete this note?"}))).subscribe(t=>{t&&(this.isDeleting=!0,this.settings.setSetting("notesSelectedId",null),this.notes.deleteNoteEntry(this.activeNoteEntryId||""))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}redirectToRecent(){const t=this.settings.getCurrentSetting("notesSelectedId");return t?this.notes.getNoteEntry(t).pipe((0,h.w)(o=>(o&&this.router.navigate(["notes",t]),f.C))):f.C}onClickRename(){this.isRenaming=!0}onClickRenameCancel(){this.isRenaming=!1,this.renamingControl.setValue(this.activeNoteEntryName||"")}onClickRenameSave(){this.isRenaming=!1,this.notes.editNoteEntry(this.activeNoteEntryId||"",t=>(t.name=this.renamingControl.value,t))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.gz),e.Y36(m.F0),e.Y36(M.D),e.Y36(se),e.Y36(b.g),e.Y36(S.U))},n.\u0275cmp=e.Xpm({type:n,selectors:[["lxs-notes"]],decls:5,vars:3,consts:[["side","",3,"activeNoteEntryId"],[4,"ngIf","ngIfElse"],["noNotes",""],[1,"header"],["notRenaming",""],[1,"note-body"],[3,"id"],["type","text",3,"formControl"],["icon","close","label","Cancel",3,"action"],["icon","check","label","Confirm",3,"action"],["icon","exit","label","Move Note",3,"action"],["icon","quill","label","Rename Note",3,"action"],["icon","delete","label","Delete Note",3,"action"]],template:function(t,o){if(1&t&&(e.TgZ(0,"lxs-split-panels"),e._UZ(1,"lxs-notes-list",0),e.YNc(2,Pe,7,3,"ng-container",1),e.YNc(3,Fe,1,0,"ng-template",null,2,e.W1O),e.qZA()),2&t){const i=e.MAs(4);e.xp6(1),e.Q6J("activeNoteEntryId",o.activeNoteEntryId),e.xp6(1),e.Q6J("ngIf",o.activeNoteEntryId)("ngIfElse",i)}},dependencies:[a.O5,N.N,d.Fj,d.JJ,d.oH,ce.f,pe,he,Ge],styles:[".header[_ngcontent-%COMP%]{display:flex;flex-flow:row;justify-content:center;align-items:center}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{flex:1;margin:0}.header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1}.header-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:3rem;height:3rem;line-height:3rem;-webkit-user-select:none;user-select:none}.header-button[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;line-height:1.5rem;color:#333}.header-button[_ngcontent-%COMP%]:hover{cursor:pointer}.header-button[_ngcontent-%COMP%]:hover > mat-icon[_ngcontent-%COMP%]{color:#555}.header-button[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem}.note-body[_ngcontent-%COMP%]{margin:1rem;padding:1rem;background-color:#f7f7f7;color:#333;box-shadow:0 0 .5rem #44444460;margin:1rem 0 0}"]}),n})(),Je=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[a.ez,G.D,I.p,A.y,Z._,d.UX,m.Bz.forChild([{path:"",component:H},{path:":id",component:H}]),D.Q,P.n,F,J]}),n})()}}]);