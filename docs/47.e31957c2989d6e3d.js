"use strict";(self.webpackChunkdungeon_tools=self.webpackChunkdungeon_tools||[]).push([[47],{5688:($,p,s)=>{s.r(p),s.d(p,{NotesModule:()=>K});var v=s(6895),a=s(4006),c=s(4269),N=s(8314),y=s(5190),E=s(5092),x=s(6051),I=s(7395),h=s(727),d=s(3900),T=s(9841),Z=s(4482);const{isArray:b}=Array;function O(n){return 1===n.length&&b(n[0])?n[0]:n}var A=s(3268),M=s(9635),k=s(3269);function f(...n){const l=(0,k.jO)(n);return l?(0,M.z)(f(...n),(0,A.Z)(l)):(0,Z.e)((e,o)=>{(0,T.l)([e,...O(n)])(o)})}function _(...n){return f(...n)}var w=s(9646),u=s(1848),S=s(6047),t=s(4650),L=s(6319),m=s(9639),g=s(3167),U=s(7392),R=s(472),J=s(1135),P=s(7579),Y=s(9300),F=s(5549),H=s(8810);let D=(()=>{class n{constructor(e,o,i,r){this.router=e,this.linker=o,this.notes=i,this.settings=r,this.noteId=new J.X(null),this.selectedInvalidLink=new P.x,this.subscriptions=new h.w0}ngOnChanges(e){e.id&&this.noteId.next(e.id.currentValue)}ngOnInit(){this.subscriptions.add(this.noteId.pipe((0,Y.h)(e=>!!e),(0,d.w)(e=>this.notes.getCurrentNoteValue(e))).subscribe(e=>{this.noteValue=e})),this.subscriptions.add(this.selectedInvalidLink.pipe((0,d.w)(e=>this.notes.addNoteEntry(e))).subscribe(e=>{this.settings.setSetting("notesSelectedId",e),this.router.navigate(["notes",e])}))}ngOnDestroy(){this.subscriptions.unsubscribe()}onNoteChanged(e){const o=this.noteId.value;o&&this.notes.updateNoteValue(o,e)}onSelectedInvalidLink(e){this.selectedInvalidLink.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.F0),t.Y36(F.I),t.Y36(g.U),t.Y36(m.g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["lxs-note-editor"]],inputs:{id:"id"},features:[t.TTD],decls:1,vars:2,consts:[["linkPreferredSource","notes",3,"value","linkEvaluator","valueChanged","selectedInvalidLink"]],template:function(e,o){1&e&&(t.TgZ(0,"lxs-inscription-editor",0),t.NdJ("valueChanged",function(r){return o.onNoteChanged(r)})("selectedInvalidLink",function(r){return o.onSelectedInvalidLink(r)}),t.qZA()),2&e&&t.Q6J("value",o.noteValue)("linkEvaluator",o.linker)},dependencies:[H.p],styles:["[_nghost-%COMP%]{display:block}"]}),n})(),Q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["lxs-notes-help"]],decls:10,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Notes Tool"),t.qZA(),t.TgZ(2,"p"),t._uU(3," Use the Notes Tool to write wiki-style notes for anything!\n"),t.qZA(),t.TgZ(4,"p"),t._uU(5," Click the plus button on the left bar to add a new note, and select notes in the list below to swap between a currently viewed note. On a note editor, select the editing button above the note to rename the note, and select the editing button on the note card to toggle between editing and viewing the note.\n"),t.qZA(),t.TgZ(6,"p"),t._uU(7,' Notes support adding links to other notes. To link to another note, surround a note\'s name in square brackets []s. The link will match the first note with the same letters and numbers, regardless of letter case, spaces, or any other symbols in the name. For example, [a-note] would link to a note named "A Note", "Ano Te", "anotE+++", or any similar name. If a note does not exist that matches the link, clicking on the link will automatically create a new note with that name.\n'),t.qZA(),t.TgZ(8,"p"),t._uU(9," Open this page again by the question mark button on the left bar.\n"),t.qZA())}}),n})();var j=s(9130);let V=(()=>{class n{constructor(e,o,i){this.router=e,this.settings=o,this.notes=i,this.subscriptions=new h.w0}ngOnInit(){this.subscriptions.add(this.notes.noteEntriesList.subscribe(e=>{this.noteEntries=e}))}ngOnDestroy(){this.subscriptions.unsubscribe()}onClickAddNoteEntry(){this.subscriptions.add(this.notes.addNoteEntry().subscribe(e=>{this.settings.setSetting("notesSelectedId",e),this.router.navigate(["notes",e])}))}onClickAboutNotes(){this.settings.setSetting("notesSelectedId",null),this.router.navigate(["notes"])}onClickNoteEntry(e){e!==this.activeNoteEntryId&&(this.settings.setSetting("notesSelectedId",e),this.router.navigate(["notes",e]))}onClickMoveNoteEntry(e){this.notes.moveNoteEntry(e.from,e.to)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.F0),t.Y36(m.g),t.Y36(g.U))},n.\u0275cmp=t.Xpm({type:n,selectors:[["lxs-notes-list"]],inputs:{activeNoteEntryId:"activeNoteEntryId"},decls:1,vars:3,consts:[["side","","label","Notes",3,"entries","selectedEntryId","showHelp","addEvent","selectEvent","moveEvent","helpEvent"]],template:function(e,o){1&e&&(t.TgZ(0,"lxs-side-listing",0),t.NdJ("addEvent",function(){return o.onClickAddNoteEntry()})("selectEvent",function(r){return o.onClickNoteEntry(r)})("moveEvent",function(r){return o.onClickMoveNoteEntry(r)})("helpEvent",function(){return o.onClickAboutNotes()}),t.qZA()),2&e&&t.Q6J("entries",o.noteEntries)("selectedEntryId",o.activeNoteEntryId)("showHelp",!0)},dependencies:[j.f]}),n})();function X(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"label"),t._uU(2," Rename: "),t._UZ(3,"input",7),t.qZA(),t.TgZ(4,"div",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onClickRenameCancel())}),t._UZ(5,"mat-icon",9),t.qZA(),t.TgZ(6,"div",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onClickRenameSave())}),t._UZ(7,"mat-icon",10),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(3),t.Q6J("formControl",e.renamingControl)}}function B(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"h1"),t._uU(1),t.qZA(),t.TgZ(2,"div",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onClickRename())}),t._UZ(3,"mat-icon",11),t.qZA(),t.TgZ(4,"div",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onClickDelete())}),t._UZ(5,"mat-icon",12),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Oqu(e.activeNoteEntryName)}}function z(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"div",3),t.YNc(2,X,8,1,"ng-container",1),t.YNc(3,B,6,1,"ng-template",null,4,t.W1O),t.qZA(),t.TgZ(5,"div",5),t._UZ(6,"lxs-note-editor",6),t.qZA(),t.BQk()),2&n){const e=t.MAs(4),o=t.oxw();t.xp6(2),t.Q6J("ngIf",o.isRenaming)("ngIfElse",e),t.xp6(4),t.Q6J("id",o.activeNoteEntryId)}}function G(n,l){1&n&&t._UZ(0,"lxs-notes-help")}let C=(()=>{class n{constructor(e,o,i,r,W){this.route=e,this.router=o,this.dialog=i,this.settings=r,this.notes=W,this.subscriptions=new h.w0,this.isRenaming=!1,this.renamingControl=new a.p4(""),this.isDeleting=!1}ngOnInit(){this.subscriptions.add(this.route.paramMap.pipe((0,d.w)(e=>{const o=e.get("id");return this.activeNoteEntryId=o??void 0,o&&"help"!==o?this.notes.getNoteEntry(o).pipe(_((0,w.of)(o))):"help"===o?(this.settings.setSetting("notesSelectedId",null),this.router.navigate(["notes"]),u.C):this.redirectToRecent()})).subscribe(([e,o])=>{e?(this.activeNoteEntryName=e.name,this.isRenaming||this.renamingControl.setValue(e.name)):this.isDeleting?(this.isDeleting=!1,this.router.navigate(["notes"])):this.router.navigate(["notes-not-found",o])}))}ngOnDestroy(){this.subscriptions.unsubscribe()}redirectToRecent(){const e=this.settings.getCurrentSetting("notesSelectedId");return e?this.notes.getNoteEntry(e).pipe((0,d.w)(o=>(o&&this.router.navigate(["notes",e]),u.C))):u.C}onClickRename(){this.isRenaming=!0}onClickRenameCancel(){this.isRenaming=!1,this.renamingControl.setValue(this.activeNoteEntryName)}onClickRenameSave(){this.isRenaming=!1,this.notes.editNoteEntry(this.activeNoteEntryId||"",e=>(e.name=this.renamingControl.value,e))}onClickDelete(){this.subscriptions.add(this.dialog.open(S.$,{data:{message:"Are you sure you want to delete this note?"}}).afterClosed().subscribe(e=>{e&&(this.isDeleting=!0,this.settings.setSetting("notesSelectedId",null),this.notes.deleteNoteEntry(this.activeNoteEntryId||""))}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.gz),t.Y36(c.F0),t.Y36(L.uw),t.Y36(m.g),t.Y36(g.U))},n.\u0275cmp=t.Xpm({type:n,selectors:[["lxs-notes"]],decls:5,vars:3,consts:[["side","",3,"activeNoteEntryId"],[4,"ngIf","ngIfElse"],["noNotes",""],[1,"header"],["notRenaming",""],[1,"note-body"],[3,"id"],["type","text",3,"formControl"],[1,"header-button",3,"click"],["svgIcon","close"],["svgIcon","check"],["svgIcon","quill"],["svgIcon","delete"]],template:function(e,o){if(1&e&&(t.TgZ(0,"lxs-split-panels"),t._UZ(1,"lxs-notes-list",0),t.YNc(2,z,7,3,"ng-container",1),t.YNc(3,G,1,0,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(4);t.xp6(1),t.Q6J("activeNoteEntryId",o.activeNoteEntryId),t.xp6(1),t.Q6J("ngIf",o.activeNoteEntryId)("ngIfElse",i)}},dependencies:[v.O5,U.Hw,a.Fj,a.JJ,a.oH,R.f,D,Q,V],styles:[".header[_ngcontent-%COMP%]{display:flex;flex-flow:row;justify-content:center;align-items:center}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{flex:1;margin:0}.header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1}.header-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:3rem;height:3rem;line-height:3rem;-webkit-user-select:none;user-select:none}.header-button[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;line-height:1.5rem;color:#333}.header-button[_ngcontent-%COMP%]:hover{cursor:pointer}.header-button[_ngcontent-%COMP%]:hover > mat-icon[_ngcontent-%COMP%]{color:#555}.header-button[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem}.note-body[_ngcontent-%COMP%]{margin:1rem;padding:1rem;background-color:#f7f7f7;color:#333;box-shadow:0 0 .5rem #44444460;margin:1rem 0 0}"]}),n})(),K=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[v.ez,y.D,N.p,E.y,a.UX,c.Bz.forChild([{path:"",component:C},{path:":id",component:C}]),x.Q,I.n]}),n})()}}]);