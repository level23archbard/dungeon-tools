"use strict";var ko=Object.defineProperty,Ao=(S,A,p)=>A in S?ko(S,A,{enumerable:!0,configurable:!0,writable:!0,value:p}):S[A]=p,an=(S,A,p)=>(Ao(S,"symbol"!=typeof A?A+"":A,p),p),hn=(S,A,p)=>{if(!A.has(S))throw TypeError("Cannot "+p)},j=(S,A,p)=>(hn(S,A,"read from private field"),p?p.call(S):A.get(S)),pt=(S,A,p)=>{if(A.has(S))throw TypeError("Cannot add the same private member more than once");A instanceof WeakSet?A.add(S):A.set(S,p)},un=(S,A,p,rt)=>(hn(S,A,"write to private field"),rt?rt.call(S,p):A.set(S,p),p),X=(S,A,p)=>(hn(S,A,"access private method"),p);(self.webpackChunkdungeon_tools=self.webpackChunkdungeon_tools||[]).push([[530],{2530:(S,A,p)=>{var B,et,ft,Jt,Ut,cn,Ft,ln,$t,fn;p.r(A),p.d(A,{MapsModule:()=>Mo});var rt=p(6895),mt=p(4006),gt=p(4269),gi=p(8314),yi=p(5190),wi=p(5092),_i=p(9614),xi=p(6051),bi=p(7395),we=p(727),dn=p(3900),vi=p(9841),pn=p(9646),mn=p(1848);const Mi=n=>{const t=n.split("_");return{col:Number(t[0]),row:Number(t[1])}};var o=p(4650),gn=p(9639),Xt=p(8273),Ti=p(472);const _e={},yn=[];function y(n,t){if(Array.isArray(n))for(const e of n)y(e,t);else if("object"!=typeof n)wn(Object.getOwnPropertyNames(t)),_e[n]=Object.assign(_e[n]||{},t);else for(const e in n)y(e,n[e])}function R(n){return _e[n]||{}}function wn(n){yn.push(...n)}function Qt(n,t){let e;const i=n.length,s=[];for(e=0;e<i;e++)s.push(t(n[e]));return s}function _n(n,t){let e;const i=n.length,s=[];for(e=0;e<i;e++)t(n[e])&&s.push(n[e]);return s}function Wt(n){return n%360*Math.PI/180}function kt(n){return n.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function xn(n){return n.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})}function xe(n){return n.charAt(0).toUpperCase()+n.slice(1)}function ot(n,t,e,i){return(null==t||null==e)&&(i=i||n.bbox(),null==t?t=i.width/i.height*e:null==e&&(e=i.height/i.width*t)),{width:t,height:e}}function Gt(n,t){const e=n.origin;let i=null!=n.ox?n.ox:null!=n.originX?n.originX:"center",s=null!=n.oy?n.oy:null!=n.originY?n.originY:"center";null!=e&&([i,s]=Array.isArray(e)?e:"object"==typeof e?[e.x,e.y]:[e,e]);const r="string"==typeof i,a="string"==typeof s;if(r||a){const{height:h,width:u,x:c,y:l}=t.bbox();r&&(i=i.includes("left")?c:i.includes("right")?c+u:c+u/2),a&&(s=s.includes("top")?l:s.includes("bottom")?l+h:l+h/2)}return[i,s]}const Vt="http://www.w3.org/2000/svg",At="http://www.w3.org/2000/xmlns/",yt="http://www.w3.org/1999/xlink",w={window:typeof window>"u"?null:window,document:typeof document>"u"?null:document};class be{}const at={},ve="___SYMBOL___ROOT___";function Et(n,t=Vt){return w.document.createElementNS(t,n)}function P(n,t=!1){if(n instanceof be)return n;if("object"==typeof n)return te(n);if(null==n)return new at[ve];if("string"==typeof n&&"<"!==n.charAt(0))return te(w.document.querySelector(n));const e=t?w.document.createElement("div"):Et("svg");return e.innerHTML=n,n=te(e.firstChild),e.removeChild(e.firstChild),n}function E(n,t){return t&&t.ownerDocument&&t instanceof t.ownerDocument.defaultView.Node?t:Et(n)}function L(n){if(!n)return null;if(n.instance instanceof be)return n.instance;if("#document-fragment"===n.nodeName)return new at.Fragment(n);let t=xe(n.nodeName||"Dom");return"LinearGradient"===t||"RadialGradient"===t?t="Gradient":at[t]||(t="Dom"),new at[t](n)}let te=L;function x(n,t=n.name,e=!1){return at[t]=n,e&&(at[ve]=n),wn(Object.getOwnPropertyNames(n.prototype)),n}let Ni=1e3;function Cn(n){return"Svgjs"+xe(n)+Ni++}function Mn(n){for(let t=n.children.length-1;t>=0;t--)Mn(n.children[t]);return n.id&&(n.id=Cn(n.nodeName)),n}function _(n,t){let e,i;for(i=(n=Array.isArray(n)?n:[n]).length-1;i>=0;i--)for(e in t)n[i].prototype[e]=t[e]}function O(n){return function(...t){const e=t[t.length-1];return!e||e.constructor!==Object||e instanceof Array?n.apply(this,t):n.apply(this,t.slice(0,-1)).attr(e)}}y("Dom",{siblings:function Di(){return this.parent().children()},position:function qi(){return this.parent().index(this)},next:function Pi(){return this.siblings()[this.position()+1]},prev:function Ri(){return this.siblings()[this.position()-1]},forward:function Zi(){const n=this.position();return this.parent().add(this.remove(),n+1),this},backward:function zi(){const n=this.position();return this.parent().add(this.remove(),n?n-1:0),this},front:function Li(){return this.parent().add(this.remove()),this},back:function Yi(){return this.parent().add(this.remove(),0),this},before:function ji(n){(n=P(n)).remove();const t=this.position();return this.parent().add(n,t),this},after:function Hi(n){(n=P(n)).remove();const t=this.position();return this.parent().add(n,t+1),this},insertBefore:function Bi(n){return(n=P(n)).before(this),this},insertAfter:function Ui(n){return(n=P(n)).after(this),this}});const Ce=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,Tn=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,kn=/rgb\((\d+),(\d+),(\d+)\)/,An=/(#[a-z_][a-z0-9\-_]*)/i,En=/\)\s*,?\s*/,On=/\s/g,Me=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i,Te=/^rgb\(/,ke=/^(\s+)?$/,Ae=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,In=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,Q=/[\s,]+/,ee=/[MLHVCSQTAZ]/i;function rs(n){const t=Math.round(n),i=Math.max(0,Math.min(255,t)).toString(16);return 1===i.length?"0"+i:i}function wt(n,t){for(let e=t.length;e--;)if(null==n[t[e]])return!1;return!0}function Ee(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+6*(t-n)*e:e<.5?t:e<2/3?n+(t-n)*(2/3-e)*6:n}y("Dom",{classes:function Fi(){const n=this.attr("class");return null==n?[]:n.trim().split(Q)},hasClass:function $i(n){return-1!==this.classes().indexOf(n)},addClass:function Ji(n){if(!this.hasClass(n)){const t=this.classes();t.push(n),this.attr("class",t.join(" "))}return this},removeClass:function Xi(n){return this.hasClass(n)&&this.attr("class",this.classes().filter(function(t){return t!==n}).join(" ")),this},toggleClass:function Qi(n){return this.hasClass(n)?this.removeClass(n):this.addClass(n)}}),y("Dom",{css:function Wi(n,t){const e={};if(0===arguments.length)return this.node.style.cssText.split(/\s*;\s*/).filter(function(i){return!!i.length}).forEach(function(i){const s=i.split(/\s*:\s*/);e[s[0]]=s[1]}),e;if(arguments.length<2){if(Array.isArray(n)){for(const i of n){const s=kt(i);e[i]=this.node.style[s]}return e}if("string"==typeof n)return this.node.style[kt(n)];if("object"==typeof n)for(const i in n)this.node.style[kt(i)]=null==n[i]||ke.test(n[i])?"":n[i]}return 2===arguments.length&&(this.node.style[kt(n)]=null==t||ke.test(t)?"":t),this},show:function Gi(){return this.css("display","")},hide:function Vi(){return this.css("display","none")},visible:function Ki(){return"none"!==this.css("display")}}),y("Dom",{data:function ts(n,t,e){if(null==n)return this.data(Qt(_n(this.node.attributes,i=>0===i.nodeName.indexOf("data-")),i=>i.nodeName.slice(5)));if(n instanceof Array){const i={};for(const s of n)i[s]=this.data(s);return i}if("object"==typeof n)for(t in n)this.data(t,n[t]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+n))}catch{return this.attr("data-"+n)}else this.attr("data-"+n,null===t?null:!0===e||"string"==typeof t||"number"==typeof t?t:JSON.stringify(t));return this}}),y("Dom",{remember:function es(n,t){if("object"==typeof arguments[0])for(const e in n)this.remember(e,n[e]);else{if(1===arguments.length)return this.memory()[n];this.memory()[n]=t}return this},forget:function ns(){if(0===arguments.length)this._memory={};else for(let n=arguments.length-1;n>=0;n--)delete this.memory()[arguments[n]];return this},memory:function is(){return this._memory=this._memory||{}}});class k{constructor(...t){this.init(...t)}static isColor(t){return t&&(t instanceof k||this.isRgb(t)||this.test(t))}static isRgb(t){return t&&"number"==typeof t.r&&"number"==typeof t.g&&"number"==typeof t.b}static random(t="vibrant",e,i){const{random:s,round:r,sin:a,PI:h}=Math;if("vibrant"===t){const u=24*s()+57,c=38*s()+45,l=360*s();return new k(u,c,l,"lch")}if("sine"===t){const u=r(80*a(2*h*(e=e??s())/.5+.01)+150),c=r(50*a(2*h*e/.5+4.6)+200),l=r(100*a(2*h*e/.5+2.3)+150);return new k(u,c,l)}if("pastel"===t){const u=8*s()+86,c=17*s()+9,l=360*s();return new k(u,c,l,"lch")}if("dark"===t){const u=10+10*s(),c=50*s()+86,l=360*s();return new k(u,c,l,"lch")}if("rgb"===t){const u=255*s(),c=255*s(),l=255*s();return new k(u,c,l)}if("lab"===t){const u=100*s(),c=256*s()-128,l=256*s()-128;return new k(u,c,l,"lab")}if("grey"===t){const u=255*s();return new k(u,u,u)}throw new Error("Unsupported random color mode")}static test(t){return"string"==typeof t&&(Me.test(t)||Te.test(t))}cmyk(){const{_a:t,_b:e,_c:i}=this.rgb(),[s,r,a]=[t,e,i].map(g=>g/255),h=Math.min(1-s,1-r,1-a);return 1===h?new k(0,0,0,1,"cmyk"):new k((1-s-h)/(1-h),(1-r-h)/(1-h),(1-a-h)/(1-h),h,"cmyk")}hsl(){const{_a:t,_b:e,_c:i}=this.rgb(),[s,r,a]=[t,e,i].map(v=>v/255),h=Math.max(s,r,a),u=Math.min(s,r,a),c=(h+u)/2,l=h===u,f=h-u;return new k(360*(l?0:h===s?((r-a)/f+(r<a?6:0))/6:h===r?((a-s)/f+2)/6:h===a?((s-r)/f+4)/6:0),100*(l?0:c>.5?f/(2-h-u):f/(h+u)),100*c,"hsl")}init(t=0,e=0,i=0,s=0,r="rgb"){if(t=t||0,this.space)for(const f in this.space)delete this[this.space[f]];if("number"==typeof t)r="string"==typeof s?s:r,s="string"==typeof s?0:s,Object.assign(this,{_a:t,_b:e,_c:i,_d:s,space:r});else if(t instanceof Array)this.space=e||("string"==typeof t[3]?t[3]:t[4])||"rgb",Object.assign(this,{_a:t[0],_b:t[1],_c:t[2],_d:t[3]||0});else if(t instanceof Object){const f=function os(n,t){const e=wt(n,"rgb")?{_a:n.r,_b:n.g,_c:n.b,_d:0,space:"rgb"}:wt(n,"xyz")?{_a:n.x,_b:n.y,_c:n.z,_d:0,space:"xyz"}:wt(n,"hsl")?{_a:n.h,_b:n.s,_c:n.l,_d:0,space:"hsl"}:wt(n,"lab")?{_a:n.l,_b:n.a,_c:n.b,_d:0,space:"lab"}:wt(n,"lch")?{_a:n.l,_b:n.c,_c:n.h,_d:0,space:"lch"}:wt(n,"cmyk")?{_a:n.c,_b:n.m,_c:n.y,_d:n.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return e.space=t||e.space,e}(t,e);Object.assign(this,f)}else if("string"==typeof t)if(Te.test(t)){const f=t.replace(On,""),[g,b,C]=kn.exec(f).slice(1,4).map(v=>parseInt(v));Object.assign(this,{_a:g,_b:b,_c:C,_d:0,space:"rgb"})}else{if(!Me.test(t))throw Error("Unsupported string format, can't construct Color");{const f=v=>parseInt(v,16),[,g,b,C]=Tn.exec(function ss(n){return 4===n.length?["#",n.substring(1,2),n.substring(1,2),n.substring(2,3),n.substring(2,3),n.substring(3,4),n.substring(3,4)].join(""):n}(t)).map(f);Object.assign(this,{_a:g,_b:b,_c:C,_d:0,space:"rgb"})}}const{_a:a,_b:h,_c:u,_d:c}=this;Object.assign(this,"rgb"===this.space?{r:a,g:h,b:u}:"xyz"===this.space?{x:a,y:h,z:u}:"hsl"===this.space?{h:a,s:h,l:u}:"lab"===this.space?{l:a,a:h,b:u}:"lch"===this.space?{l:a,c:h,h:u}:"cmyk"===this.space?{c:a,m:h,y:u,k:c}:{})}lab(){const{x:t,y:e,z:i}=this.xyz();return new k(116*e-16,500*(t-e),200*(e-i),"lab")}lch(){const{l:t,a:e,b:i}=this.lab(),s=Math.sqrt(e**2+i**2);let r=180*Math.atan2(i,e)/Math.PI;return r<0&&(r*=-1,r=360-r),new k(t,s,r,"lch")}rgb(){if("rgb"===this.space)return this;if(function as(n){return"lab"===n||"xyz"===n||"lch"===n}(this.space)){let{x:t,y:e,z:i}=this;if("lab"===this.space||"lch"===this.space){let{l:b,a:C,b:v}=this;if("lch"===this.space){const{c:dt,h:ge}=this,ye=Math.PI/180;C=dt*Math.cos(ye*ge),v=dt*Math.sin(ye*ge)}const T=(b+16)/116,I=C/500+T,q=T-v/200,U=16/116,it=.008856,st=7.787;t=.95047*(I**3>it?I**3:(I-U)/st),e=1*(T**3>it?T**3:(T-U)/st),i=1.08883*(q**3>it?q**3:(q-U)/st)}const s=3.2406*t+-1.5372*e+-.4986*i,r=-.9689*t+1.8758*e+.0415*i,a=.0557*t+-.204*e+1.057*i,h=Math.pow,u=.0031308,c=s>u?1.055*h(s,1/2.4)-.055:12.92*s,l=r>u?1.055*h(r,1/2.4)-.055:12.92*r,f=a>u?1.055*h(a,1/2.4)-.055:12.92*a;return new k(255*c,255*l,255*f)}if("hsl"===this.space){let{h:t,s:e,l:i}=this;if(t/=360,e/=100,i/=100,0===e)return i*=255,new k(i,i,i);const s=i<.5?i*(1+e):i+e-i*e,r=2*i-s,a=255*Ee(r,s,t+1/3),h=255*Ee(r,s,t),u=255*Ee(r,s,t-1/3);return new k(a,h,u)}if("cmyk"===this.space){const{c:t,m:e,y:i,k:s}=this,r=255*(1-Math.min(1,t*(1-s)+s)),a=255*(1-Math.min(1,e*(1-s)+s)),h=255*(1-Math.min(1,i*(1-s)+s));return new k(r,a,h)}return this}toArray(){const{_a:t,_b:e,_c:i,_d:s,space:r}=this;return[t,e,i,s,r]}toHex(){const[t,e,i]=this._clamped().map(rs);return`#${t}${e}${i}`}toRgb(){const[t,e,i]=this._clamped();return`rgb(${t},${e},${i})`}toString(){return this.toHex()}xyz(){const{_a:t,_b:e,_c:i}=this.rgb(),[s,r,a]=[t,e,i].map(I=>I/255),h=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92,u=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,c=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92,l=(.4124*h+.3576*u+.1805*c)/.95047,f=(.2126*h+.7152*u+.0722*c)/1,g=(.0193*h+.1192*u+.9505*c)/1.08883,b=l>.008856?Math.pow(l,1/3):7.787*l+16/116,C=f>.008856?Math.pow(f,1/3):7.787*f+16/116,v=g>.008856?Math.pow(g,1/3):7.787*g+16/116;return new k(b,C,v,"xyz")}_clamped(){const{_a:t,_b:e,_c:i}=this.rgb(),{max:s,min:r,round:a}=Math;return[t,e,i].map(u=>s(0,r(a(u),255)))}}class N{constructor(...t){this.init(...t)}clone(){return new N(this)}init(t,e){const s=Array.isArray(t)?{x:t[0],y:t[1]}:"object"==typeof t?{x:t.x,y:t.y}:{x:t,y:e};return this.x=s.x??0,this.y=s.y??0,this}toArray(){return[this.x,this.y]}transform(t){return this.clone().transformO(t)}transformO(t){d.isMatrixLike(t)||(t=new d(t));const{x:e,y:i}=this;return this.x=t.a*e+t.c*i+t.e,this.y=t.b*e+t.d*i+t.f,this}}function _t(n,t,e){return Math.abs(t-n)<(e||1e-6)}class d{constructor(...t){this.init(...t)}static formatTransforms(t){const e="both"===t.flip||!0===t.flip,i=t.flip&&(e||"x"===t.flip)?-1:1,s=t.flip&&(e||"y"===t.flip)?-1:1,r=t.skew&&t.skew.length?t.skew[0]:isFinite(t.skew)?t.skew:isFinite(t.skewX)?t.skewX:0,a=t.skew&&t.skew.length?t.skew[1]:isFinite(t.skew)?t.skew:isFinite(t.skewY)?t.skewY:0,h=t.scale&&t.scale.length?t.scale[0]*i:isFinite(t.scale)?t.scale*i:isFinite(t.scaleX)?t.scaleX*i:i,u=t.scale&&t.scale.length?t.scale[1]*s:isFinite(t.scale)?t.scale*s:isFinite(t.scaleY)?t.scaleY*s:s,c=t.shear||0,l=t.rotate||t.theta||0,f=new N(t.origin||t.around||t.ox||t.originX,t.oy||t.originY),g=f.x,b=f.y,C=new N(t.position||t.px||t.positionX||NaN,t.py||t.positionY||NaN),v=C.x,T=C.y,I=new N(t.translate||t.tx||t.translateX,t.ty||t.translateY),q=I.x,U=I.y,it=new N(t.relative||t.rx||t.relativeX,t.ry||t.relativeY);return{scaleX:h,scaleY:u,skewX:r,skewY:a,shear:c,theta:l,rx:it.x,ry:it.y,tx:q,ty:U,ox:g,oy:b,px:v,py:T}}static fromArray(t){return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}static isMatrixLike(t){return null!=t.a||null!=t.b||null!=t.c||null!=t.d||null!=t.e||null!=t.f}static matrixMultiply(t,e,i){const r=t.b*e.a+t.d*e.b,a=t.a*e.c+t.c*e.d,h=t.b*e.c+t.d*e.d,u=t.e+t.a*e.e+t.c*e.f,c=t.f+t.b*e.e+t.d*e.f;return i.a=t.a*e.a+t.c*e.b,i.b=r,i.c=a,i.d=h,i.e=u,i.f=c,i}around(t,e,i){return this.clone().aroundO(t,e,i)}aroundO(t,e,i){const s=t||0,r=e||0;return this.translateO(-s,-r).lmultiplyO(i).translateO(s,r)}clone(){return new d(this)}decompose(t=0,e=0){const i=this.a,s=this.b,r=this.c,a=this.d,h=this.e,u=this.f,c=i*a-s*r,l=c>0?1:-1,f=l*Math.sqrt(i*i+s*s),g=Math.atan2(l*s,l*i),b=180/Math.PI*g,C=Math.cos(g),v=Math.sin(g),T=(i*r+s*a)/c,I=r*f/(T*i-s)||a*f/(T*s+i);return{scaleX:f,scaleY:I,shear:T,rotate:b,translateX:h-t+t*C*f+e*(T*C*f-v*I),translateY:u-e+t*v*f+e*(T*v*f+C*I),originX:t,originY:e,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}equals(t){if(t===this)return!0;const e=new d(t);return _t(this.a,e.a)&&_t(this.b,e.b)&&_t(this.c,e.c)&&_t(this.d,e.d)&&_t(this.e,e.e)&&_t(this.f,e.f)}flip(t,e){return this.clone().flipO(t,e)}flipO(t,e){return"x"===t?this.scaleO(-1,1,e,0):"y"===t?this.scaleO(1,-1,0,e):this.scaleO(-1,-1,t,e||t)}init(t){const e=d.fromArray([1,0,0,1,0,0]);return t=t instanceof W?t.matrixify():"string"==typeof t?d.fromArray(t.split(Q).map(parseFloat)):Array.isArray(t)?d.fromArray(t):"object"==typeof t&&d.isMatrixLike(t)?t:"object"==typeof t?(new d).transform(t):6===arguments.length?d.fromArray([].slice.call(arguments)):e,this.a=null!=t.a?t.a:e.a,this.b=null!=t.b?t.b:e.b,this.c=null!=t.c?t.c:e.c,this.d=null!=t.d?t.d:e.d,this.e=null!=t.e?t.e:e.e,this.f=null!=t.f?t.f:e.f,this}inverse(){return this.clone().inverseO()}inverseO(){const t=this.a,e=this.b,i=this.c,s=this.d,r=this.e,a=this.f,h=t*s-e*i;if(!h)throw new Error("Cannot invert "+this);const u=s/h,c=-e/h,l=-i/h,f=t/h,g=-(u*r+l*a),b=-(c*r+f*a);return this.a=u,this.b=c,this.c=l,this.d=f,this.e=g,this.f=b,this}lmultiply(t){return this.clone().lmultiplyO(t)}lmultiplyO(t){const i=t instanceof d?t:new d(t);return d.matrixMultiply(i,this,this)}multiply(t){return this.clone().multiplyO(t)}multiplyO(t){const i=t instanceof d?t:new d(t);return d.matrixMultiply(this,i,this)}rotate(t,e,i){return this.clone().rotateO(t,e,i)}rotateO(t,e=0,i=0){t=Wt(t);const s=Math.cos(t),r=Math.sin(t),{a,b:h,c:u,d:c,e:l,f}=this;return this.a=a*s-h*r,this.b=h*s+a*r,this.c=u*s-c*r,this.d=c*s+u*r,this.e=l*s-f*r+i*r-e*s+e,this.f=f*s+l*r-e*r-i*s+i,this}scale(t,e,i,s){return this.clone().scaleO(...arguments)}scaleO(t,e=t,i=0,s=0){3===arguments.length&&(s=i,i=e,e=t);const{a:r,b:a,c:h,d:u,e:c,f:l}=this;return this.a=r*t,this.b=a*e,this.c=h*t,this.d=u*e,this.e=c*t-i*t+i,this.f=l*e-s*e+s,this}shear(t,e,i){return this.clone().shearO(t,e,i)}shearO(t,e=0,i=0){const{a:s,b:r,c:a,d:h,e:u,f:c}=this;return this.a=s+r*t,this.c=a+h*t,this.e=u+c*t-i*t,this}skew(t,e,i,s){return this.clone().skewO(...arguments)}skewO(t,e=t,i=0,s=0){3===arguments.length&&(s=i,i=e,e=t),t=Wt(t),e=Wt(e);const r=Math.tan(t),a=Math.tan(e),{a:h,b:u,c,d:l,e:f,f:g}=this;return this.a=h+u*r,this.b=u+h*a,this.c=c+l*r,this.d=l+c*a,this.e=f+g*r-s*r,this.f=g+f*a-i*a,this}skewX(t,e,i){return this.skew(t,0,e,i)}skewY(t,e,i){return this.skew(0,t,e,i)}toArray(){return[this.a,this.b,this.c,this.d,this.e,this.f]}toString(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}transform(t){if(d.isMatrixLike(t))return new d(t).multiplyO(this);const e=d.formatTransforms(t),{x:s,y:r}=new N(e.ox,e.oy).transform(this),a=(new d).translateO(e.rx,e.ry).lmultiplyO(this).translateO(-s,-r).scaleO(e.scaleX,e.scaleY).skewO(e.skewX,e.skewY).shearO(e.shear).rotateO(e.theta).translateO(s,r);if(isFinite(e.px)||isFinite(e.py)){const h=new N(s,r).transform(a),u=isFinite(e.px)?e.px-h.x:0,c=isFinite(e.py)?e.py-h.y:0;a.translateO(u,c)}return a.translateO(e.tx,e.ty),a}translate(t,e){return this.clone().translateO(t,e)}translateO(t,e){return this.e+=t||0,this.f+=e||0,this}valueOf(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}}function G(){if(!G.nodes){const n=P().size(2,0);n.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),n.attr("focusable","false"),n.attr("aria-hidden","true");const t=n.path().node;G.nodes={svg:n,path:t}}return G.nodes.svg.node.parentNode||G.nodes.svg.addTo(w.document.body||w.document.documentElement),G.nodes}function Sn(n){return!(n.width||n.height||n.x||n.y)}x(d,"Matrix");class D{constructor(...t){this.init(...t)}addOffset(){return this.x+=w.window.pageXOffset,this.y+=w.window.pageYOffset,new D(this)}init(t){return t="string"==typeof t?t.split(Q).map(parseFloat):Array.isArray(t)?t:"object"==typeof t?[null!=t.left?t.left:t.x,null!=t.top?t.top:t.y,t.width,t.height]:4===arguments.length?[].slice.call(arguments):[0,0,0,0],this.x=t[0]||0,this.y=t[1]||0,this.width=this.w=t[2]||0,this.height=this.h=t[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}isNulled(){return Sn(this)}merge(t){const e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),s=Math.max(this.x+this.width,t.x+t.width)-e,r=Math.max(this.y+this.height,t.y+t.height)-i;return new D(e,i,s,r)}toArray(){return[this.x,this.y,this.width,this.height]}toString(){return this.x+" "+this.y+" "+this.width+" "+this.height}transform(t){t instanceof d||(t=new d(t));let e=1/0,i=-1/0,s=1/0,r=-1/0;return[new N(this.x,this.y),new N(this.x2,this.y),new N(this.x,this.y2),new N(this.x2,this.y2)].forEach(function(h){h=h.transform(t),e=Math.min(e,h.x),i=Math.max(i,h.x),s=Math.min(s,h.y),r=Math.max(r,h.y)}),new D(e,s,i-e,r-s)}}function Nn(n,t,e){let i;try{if(i=t(n.node),Sn(i)&&!function ls(n){return n===w.document||(w.document.documentElement.contains||function(t){for(;t.parentNode;)t=t.parentNode;return t===w.document}).call(w.document.documentElement,n)}(n.node))throw new Error("Element not in the dom")}catch{i=e(n)}return i}y({viewbox:{viewbox(n,t,e,i){return null==n?new D(this.attr("viewBox")):this.attr("viewBox",new D(n,t,e,i))},zoom(n,t){let{width:e,height:i}=this.attr(["width","height"]);if((!e&&!i||"string"==typeof e||"string"==typeof i)&&(e=this.node.clientWidth,i=this.node.clientHeight),!e||!i)throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element");const s=this.viewbox(),r=e/s.width,a=i/s.height,h=Math.min(r,a);if(null==n)return h;let u=h/n;u===1/0&&(u=Number.MAX_SAFE_INTEGER/100),t=t||new N(e/2/r+s.x,i/2/a+s.y);const c=new D(s).transform(new d({scale:u,origin:t}));return this.viewbox(c)}}}),x(D,"Box");class ht extends Array{constructor(t=[],...e){if(super(t,...e),"number"==typeof t)return this;this.length=0,this.push(...t)}}_([ht],{each(n,...t){return this.map("function"==typeof n?(e,i,s)=>n.call(e,e,i,s):e=>e[n](...t))},toArray(){return Array.prototype.concat.apply([],this)}});const ms=["toArray","constructor","each"];function xt(n,t){return new ht(Qt((t||w.document).querySelectorAll(n),function(e){return L(e)}))}ht.extend=function(n){n=n.reduce((t,e)=>(ms.includes(e)||"_"===e[0]||(t[e]=function(...i){return this.each(e,...i)}),t),{}),_([ht],n)};let ws=0;const Dn={};function qn(n){let t=n.getEventHolder();return t===w.window&&(t=Dn),t.events||(t.events={}),t.events}function Oe(n){return n.getEventTarget()}function Ie(n,t,e,i,s){const r=e.bind(i||n),a=P(n),h=qn(a),u=Oe(a);t=Array.isArray(t)?t:t.split(Q),e._svgjsListenerId||(e._svgjsListenerId=++ws),t.forEach(function(c){const l=c.split(".")[0],f=c.split(".")[1]||"*";h[l]=h[l]||{},h[l][f]=h[l][f]||{},h[l][f][e._svgjsListenerId]=r,u.addEventListener(l,r,s||!1)})}function bt(n,t,e,i){const s=P(n),r=qn(s),a=Oe(s);"function"==typeof e&&!(e=e._svgjsListenerId)||(t=Array.isArray(t)?t:(t||"").split(Q)).forEach(function(h){const u=h&&h.split(".")[0],c=h&&h.split(".")[1];let l,f;if(e)r[u]&&r[u][c||"*"]&&(a.removeEventListener(u,r[u][c||"*"][e],i||!1),delete r[u][c||"*"][e]);else if(u&&c){if(r[u]&&r[u][c]){for(f in r[u][c])bt(a,[u,c].join("."),f);delete r[u][c]}}else if(c)for(h in r)for(l in r[h])c===l&&bt(a,[h,c].join("."));else if(u){if(r[u]){for(l in r[u])bt(a,[u,l].join("."));delete r[u]}}else{for(h in r)bt(a,h);!function _s(n){let t=n.getEventHolder();t===w.window&&(t=Dn),t.events&&(t.events={})}(s)}})}class Ot extends be{addEventListener(){}dispatch(t,e,i){return function xs(n,t,e,i){const s=Oe(n);return t instanceof w.window.Event||(t=new w.window.CustomEvent(t,{detail:e,cancelable:!0,...i})),s.dispatchEvent(t),t}(this,t,e,i)}dispatchEvent(t){const e=this.getEventHolder().events;if(!e)return!0;const i=e[t.type];for(const s in i)for(const r in i[s])i[s][r](t);return!t.defaultPrevented}fire(t,e,i){return this.dispatch(t,e,i),this}getEventHolder(){return this}getEventTarget(){return this}off(t,e,i){return bt(this,t,e,i),this}on(t,e,i,s){return Ie(this,t,e,i,s),this}removeEventListener(){}}function Se(){}x(Ot,"EventTarget");const vt_duration=400,vt_ease=">",vt_delay=0,Pn={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"};class Ct extends Array{constructor(...t){super(...t),this.init(...t)}clone(){return new this.constructor(this)}init(t){return"number"==typeof t||(this.length=0,this.push(...this.parse(t))),this}parse(t=[]){return t instanceof Array?t:t.trim().split(Q).map(parseFloat)}toArray(){return Array.prototype.concat.apply([],this)}toSet(){return new Set(this)}toString(){return this.join(" ")}valueOf(){const t=[];return t.push(...this),t}}class m{constructor(...t){this.init(...t)}convert(t){return new m(this.value,t)}divide(t){return t=new m(t),new m(this/t,this.unit||t.unit)}init(t,e){return e=Array.isArray(t)?t[1]:e,t=Array.isArray(t)?t[0]:t,this.value=0,this.unit=e||"","number"==typeof t?this.value=isNaN(t)?0:isFinite(t)?t:t<0?-34e37:34e37:"string"==typeof t?(e=t.match(Ce))&&(this.value=parseFloat(e[1]),"%"===e[5]?this.value/=100:"s"===e[5]&&(this.value*=1e3),this.unit=e[5]):t instanceof m&&(this.value=t.valueOf(),this.unit=t.unit),this}minus(t){return t=new m(t),new m(this-t,this.unit||t.unit)}plus(t){return t=new m(t),new m(this+t,this.unit||t.unit)}times(t){return t=new m(t),new m(this*t,this.unit||t.unit)}toArray(){return[this.value,this.unit]}toJSON(){return this.toString()}toString(){return("%"===this.unit?~~(1e8*this.value)/1e6:"s"===this.unit?this.value/1e3:this.value)+this.unit}valueOf(){return this.value}}const Rn=[];class V extends Ot{constructor(t,e){super(),this.node=t,this.type=t.nodeName,e&&t!==e&&this.attr(e)}add(t,e){return(t=P(t)).removeNamespace&&this.node instanceof w.window.SVGElement&&t.removeNamespace(),null==e?this.node.appendChild(t.node):t.node!==this.node.childNodes[e]&&this.node.insertBefore(t.node,this.node.childNodes[e]),this}addTo(t,e){return P(t).put(this,e)}children(){return new ht(Qt(this.node.children,function(t){return L(t)}))}clear(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}clone(t=!0){return this.writeDataToDom(),new this.constructor(Mn(this.node.cloneNode(t)))}each(t,e){const i=this.children();let s,r;for(s=0,r=i.length;s<r;s++)t.apply(i[s],[s,i]),e&&i[s].each(t,e);return this}element(t,e){return this.put(new V(Et(t),e))}first(){return L(this.node.firstChild)}get(t){return L(this.node.childNodes[t])}getEventHolder(){return this.node}getEventTarget(){return this.node}has(t){return this.index(t)>=0}html(t,e){return this.xml(t,e,"http://www.w3.org/1999/xhtml")}id(t){return typeof t>"u"&&!this.node.id&&(this.node.id=Cn(this.type)),this.attr("id",t)}index(t){return[].slice.call(this.node.childNodes).indexOf(t.node)}last(){return L(this.node.lastChild)}matches(t){const e=this.node,i=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return i&&i.call(e,t)}parent(t){let e=this;if(!e.node.parentNode)return null;if(e=L(e.node.parentNode),!t)return e;do{if("string"==typeof t?e.matches(t):e instanceof t)return e}while(e=L(e.node.parentNode));return e}put(t,e){return t=P(t),this.add(t,e),t}putIn(t,e){return P(t).add(this,e)}remove(){return this.parent()&&this.parent().removeElement(this),this}removeElement(t){return this.node.removeChild(t.node),this}replace(t){return t=P(t),this.node.parentNode&&this.node.parentNode.replaceChild(t.node,this.node),t}round(t=2,e=null){const i=10**t,s=this.attr(e);for(const r in s)"number"==typeof s[r]&&(s[r]=Math.round(s[r]*i)/i);return this.attr(s),this}svg(t,e){return this.xml(t,e,Vt)}toString(){return this.id()}words(t){return this.node.textContent=t,this}wrap(t){const e=this.parent();if(!e)return this.addTo(t);const i=e.index(this);return e.put(t,i).put(this)}writeDataToDom(){return this.each(function(){this.writeDataToDom()}),this}xml(t,e,i){if("boolean"==typeof t&&(i=e,e=t,t=null),null==t||"function"==typeof t){e=e??!0,this.writeDataToDom();let h=this;if(null!=t){if(h=L(h.node.cloneNode(!0)),e){const u=t(h);if(h=u||h,!1===u)return""}h.each(function(){const u=t(this),c=u||this;!1===u?this.remove():u&&this!==c&&this.replace(c)},!0)}return e?h.node.outerHTML:h.node.innerHTML}e=e??!1;const s=Et("wrapper",i),r=w.document.createDocumentFragment();s.innerHTML=t;for(let h=s.children.length;h--;)r.appendChild(s.firstElementChild);const a=this.parent();return e?this.replace(r)&&a:this.add(r)}}_(V,{attr:function vs(n,t,e){if(null==n){n={},t=this.node.attributes;for(const i of t)n[i.nodeName]=Ae.test(i.nodeValue)?parseFloat(i.nodeValue):i.nodeValue;return n}if(n instanceof Array)return n.reduce((i,s)=>(i[s]=this.attr(s),i),{});if("object"==typeof n&&n.constructor===Object)for(t in n)this.attr(t,n[t]);else if(null===t)this.node.removeAttribute(n);else{if(null==t)return null==(t=this.node.getAttribute(n))?Pn[n]:Ae.test(t)?parseFloat(t):t;"number"==typeof(t=Rn.reduce((i,s)=>s(n,i,this),t))?t=new m(t):k.isColor(t)?t=new k(t):t.constructor===Array&&(t=new Ct(t)),"leading"===n?this.leading&&this.leading(t):"string"==typeof e?this.node.setAttributeNS(e,n,t.toString()):this.node.setAttribute(n,t.toString()),this.rebuild&&("font-size"===n||"x"===n)&&this.rebuild()}return this},find:function gs(n){return xt(n,this.node)},findOne:function ys(n){return L(this.node.querySelector(n))}}),x(V,"Dom");class W extends V{constructor(t,e){super(t,e),this.dom={},this.node.instance=this,t.hasAttribute("svgjs:data")&&this.setData(JSON.parse(t.getAttribute("svgjs:data"))||{})}center(t,e){return this.cx(t).cy(e)}cx(t){return null==t?this.x()+this.width()/2:this.x(t-this.width()/2)}cy(t){return null==t?this.y()+this.height()/2:this.y(t-this.height()/2)}defs(){const t=this.root();return t&&t.defs()}dmove(t,e){return this.dx(t).dy(e)}dx(t=0){return this.x(new m(t).plus(this.x()))}dy(t=0){return this.y(new m(t).plus(this.y()))}getEventHolder(){return this}height(t){return this.attr("height",t)}move(t,e){return this.x(t).y(e)}parents(t=this.root()){const e="string"==typeof t;e||(t=P(t));const i=new ht;let s=this;for(;(s=s.parent())&&s.node!==w.document&&"#document-fragment"!==s.nodeName&&(i.push(s),!(!e&&s.node===t.node||e&&s.matches(t)));)if(s.node===this.root().node)return null;return i}reference(t){if(!(t=this.attr(t)))return null;const e=(t+"").match(An);return e?P(e[1]):null}root(){const t=this.parent(function Si(n){return at[n]}(ve));return t&&t.root()}setData(t){return this.dom=t,this}size(t,e){const i=ot(this,t,e);return this.width(new m(i.width)).height(new m(i.height))}width(t){return this.attr("width",t)}writeDataToDom(){return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),super.writeDataToDom()}x(t){return this.attr("x",t)}y(t){return this.attr("y",t)}}_(W,{bbox:function fs(){const e=Nn(this,s=>s.getBBox(),s=>{try{const r=s.clone().addTo(G().svg).show(),a=r.node.getBBox();return r.remove(),a}catch(r){throw new Error(`Getting bbox of element "${s.node.nodeName}" is not possible: ${r.toString()}`)}});return new D(e)},rbox:function ds(n){const i=Nn(this,r=>r.getBoundingClientRect(),r=>{throw new Error(`Getting rbox of element "${r.node.nodeName}" is not possible`)}),s=new D(i);return n?s.transform(n.screenCTM().inverseO()):s.addOffset()},inside:function ps(n,t){const e=this.bbox();return n>e.x&&t>e.y&&n<e.x+e.width&&t<e.y+e.height},point:function hs(n,t){return new N(n,t).transform(this.screenCTM().inverse())},ctm:function us(){return new d(this.node.getCTM())},screenCTM:function cs(){if("function"==typeof this.isRoot&&!this.isRoot()){const n=this.rect(1,1),t=n.node.getScreenCTM();return n.remove(),new d(t)}return new d(this.node.getScreenCTM())}}),x(W,"Element");const It={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(n,t){return"color"===t?n:n+"-"+t}};["fill","stroke"].forEach(function(n){const t={};let e;t[n]=function(i){if(typeof i>"u")return this.attr(n);if("string"==typeof i||i instanceof k||k.isRgb(i)||i instanceof W)this.attr(n,i);else for(e=It[n].length-1;e>=0;e--)null!=i[It[n][e]]&&this.attr(It.prefix(n,It[n][e]),i[It[n][e]]);return this},y(["Element","Runner"],t)}),y(["Element","Runner"],{matrix:function(n,t,e,i,s,r){return null==n?new d(this):this.attr("transform",new d(n,t,e,i,s,r))},rotate:function(n,t,e){return this.transform({rotate:n,ox:t,oy:e},!0)},skew:function(n,t,e,i){return this.transform(1===arguments.length||3===arguments.length?{skew:n,ox:t,oy:e}:{skew:[n,t],ox:e,oy:i},!0)},shear:function(n,t,e){return this.transform({shear:n,ox:t,oy:e},!0)},scale:function(n,t,e,i){return this.transform(1===arguments.length||3===arguments.length?{scale:n,ox:t,oy:e}:{scale:[n,t],ox:e,oy:i},!0)},translate:function(n,t){return this.transform({translate:[n,t]},!0)},relative:function(n,t){return this.transform({relative:[n,t]},!0)},flip:function(n="both",t="center"){return-1==="xybothtrue".indexOf(n)&&(t=n,n="both"),this.transform({flip:n,origin:t},!0)},opacity:function(n){return this.attr("opacity",n)}}),y("radius",{radius:function(n,t=n){return"radialGradient"===(this._element||this).type?this.attr("r",new m(n)):this.rx(n).ry(t)}}),y("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(n){return new N(this.node.getPointAtLength(n))}}),y(["Element","Runner"],{font:function(n,t){if("object"==typeof n){for(t in n)this.font(t,n[t]);return this}return"leading"===n?this.leading(t):this.attr("anchor"===n?"text-anchor":"size"===n||"family"===n||"weight"===n||"stretch"===n||"variant"===n||"style"===n?"font-"+n:n,t)}}),y("Element",["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].reduce(function(n,t){return n[t]=function(i){return null===i?this.off(t):this.on(t,i),this},n},{})),y("Element",{untransform:function Ms(){return this.attr("transform",null)},matrixify:function Ts(){return(this.attr("transform")||"").split(En).slice(0,-1).map(function(t){const e=t.trim().split("(");return[e[0],e[1].split(Q).map(function(i){return parseFloat(i)})]}).reverse().reduce(function(t,e){return"matrix"===e[0]?t.lmultiply(d.fromArray(e[1])):t[e[0]].apply(t,e[1])},new d)},toParent:function ks(n,t){if(this===n)return this;const e=this.screenCTM(),i=n.screenCTM().inverse();return this.addTo(n,t).untransform().transform(i.multiply(e)),this},toRoot:function As(n){return this.toParent(this.root(),n)},transform:function Es(n,t){if(null==n||"string"==typeof n){const s=new d(this).decompose();return null==n?s:s[n]}d.isMatrixLike(n)||(n={...n,origin:Gt(n,this)});const i=new d(!0===t?this:t||!1).transform(n);return this.attr("transform",i)}});class Z extends W{flatten(t=this,e){return this.each(function(){if(this instanceof Z)return this.flatten().ungroup()}),this}ungroup(t=this.parent(),e=t.index(this)){return e=-1===e?t.children().length:e,this.each(function(i,s){return s[s.length-i-1].toParent(t,e)}),this.remove()}}x(Z,"Container");class ne extends Z{constructor(t,e=t){super(E("defs",t),e)}flatten(){return this}ungroup(){return this}}x(ne,"Defs");class Y extends W{}function Ne(n){return this.attr("rx",n)}function De(n){return this.attr("ry",n)}function Zn(n){return null==n?this.cx()-this.rx():this.cx(n+this.rx())}function zn(n){return null==n?this.cy()-this.ry():this.cy(n+this.ry())}function Ln(n){return this.attr("cx",n)}function Yn(n){return this.attr("cy",n)}function jn(n){return null==n?2*this.rx():this.rx(new m(n).divide(2))}function Hn(n){return null==n?2*this.ry():this.ry(new m(n).divide(2))}x(Y,"Shape");var Os={__proto__:null,rx:Ne,ry:De,x:Zn,y:zn,cx:Ln,cy:Yn,width:jn,height:Hn};class ie extends Y{constructor(t,e=t){super(E("ellipse",t),e)}size(t,e){const i=ot(this,t,e);return this.rx(new m(i.width).divide(2)).ry(new m(i.height).divide(2))}}_(ie,Os),y("Container",{ellipse:O(function(n=0,t=n){return this.put(new ie).size(n,t).move(0,0)})}),x(ie,"Ellipse");class Bn extends V{constructor(t=w.document.createDocumentFragment()){super(t)}xml(t,e,i){if("boolean"==typeof t&&(i=e,e=t,t=null),null==t||"function"==typeof t){const s=new V(Et("wrapper",i));return s.add(this.node.cloneNode(!0)),s.xml(!1,i)}return super.xml(t,!1,i)}}function Un(n,t){return this.attr("radialGradient"===(this._element||this).type?{fx:new m(n),fy:new m(t)}:{x1:new m(n),y1:new m(t)})}function Fn(n,t){return this.attr("radialGradient"===(this._element||this).type?{cx:new m(n),cy:new m(t)}:{x2:new m(n),y2:new m(t)})}x(Bn,"Fragment");var Is={__proto__:null,from:Un,to:Fn};class St extends Z{constructor(t,e){super(E(t+"Gradient","string"==typeof t?null:t),e)}attr(t,e,i){return"transform"===t&&(t="gradientTransform"),super.attr(t,e,i)}bbox(){return new D}targets(){return xt('svg [fill*="'+this.id()+'"]')}toString(){return this.url()}update(t){return this.clear(),"function"==typeof t&&t.call(this,this),this}url(){return'url("#'+this.id()+'")'}}_(St,Is),y({Container:{gradient(...n){return this.defs().gradient(...n)}},Defs:{gradient:O(function(n,t){return this.put(new St(n)).update(t)})}}),x(St,"Gradient");class Nt extends Z{constructor(t,e=t){super(E("pattern",t),e)}attr(t,e,i){return"transform"===t&&(t="patternTransform"),super.attr(t,e,i)}bbox(){return new D}targets(){return xt('svg [fill*="'+this.id()+'"]')}toString(){return this.url()}update(t){return this.clear(),"function"==typeof t&&t.call(this,this),this}url(){return'url("#'+this.id()+'")'}}y({Container:{pattern(...n){return this.defs().pattern(...n)}},Defs:{pattern:O(function(n,t,e){return this.put(new Nt).update(e).attr({x:0,y:0,width:n,height:t,patternUnits:"userSpaceOnUse"})})}}),x(Nt,"Pattern");class se extends Y{constructor(t,e=t){super(E("image",t),e)}load(t,e){if(!t)return this;const i=new w.window.Image;return Ie(i,"load",function(s){const r=this.parent(Nt);0===this.width()&&0===this.height()&&this.size(i.width,i.height),r instanceof Nt&&0===r.width()&&0===r.height()&&r.size(this.width(),this.height()),"function"==typeof e&&e.call(this,s)},this),Ie(i,"load error",function(){bt(i)}),this.attr("href",i.src=t,yt)}}(function bs(n){Rn.push(n)})(function(n,t,e){return("fill"===n||"stroke"===n)&&In.test(t)&&(t=e.root().defs().image(t)),t instanceof se&&(t=e.root().defs().pattern(0,0,i=>{i.add(t)})),t}),y({Container:{image:O(function(n,t){return this.put(new se).size(0,0).load(n,t)})}}),x(se,"Image");class K extends Ct{bbox(){let t=-1/0,e=-1/0,i=1/0,s=1/0;return this.forEach(function(r){t=Math.max(r[0],t),e=Math.max(r[1],e),i=Math.min(r[0],i),s=Math.min(r[1],s)}),new D(i,s,t-i,e-s)}move(t,e){const i=this.bbox();if(t-=i.x,e-=i.y,!isNaN(t)&&!isNaN(e))for(let s=this.length-1;s>=0;s--)this[s]=[this[s][0]+t,this[s][1]+e];return this}parse(t=[0,0]){const e=[];(t=t instanceof Array?Array.prototype.concat.apply([],t):t.trim().split(Q).map(parseFloat)).length%2!=0&&t.pop();for(let i=0,s=t.length;i<s;i+=2)e.push([t[i],t[i+1]]);return e}size(t,e){let i;const s=this.bbox();for(i=this.length-1;i>=0;i--)s.width&&(this[i][0]=(this[i][0]-s.x)*t/s.width+s.x),s.height&&(this[i][1]=(this[i][1]-s.y)*e/s.height+s.y);return this}toLine(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}toString(){const t=[];for(let e=0,i=this.length;e<i;e++)t.push(this[e].join(","));return t.join(" ")}transform(t){return this.clone().transformO(t)}transformO(t){d.isMatrixLike(t)||(t=new d(t));for(let e=this.length;e--;){const[i,s]=this[e];this[e][0]=t.a*i+t.c*s+t.e,this[e][1]=t.b*i+t.d*s+t.f}return this}}var qe={__proto__:null,MorphArray:K,x:function Ns(n){return null==n?this.bbox().x:this.move(n,this.bbox().y)},y:function Ds(n){return null==n?this.bbox().y:this.move(this.bbox().x,n)},width:function qs(n){const t=this.bbox();return null==n?t.width:this.size(n,t.height)},height:function Ps(n){const t=this.bbox();return null==n?t.height:this.size(t.width,n)}};class Dt extends Y{constructor(t,e=t){super(E("line",t),e)}array(){return new K([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}move(t,e){return this.attr(this.array().move(t,e).toLine())}plot(t,e,i,s){return null==t?this.array():(t=typeof e<"u"?{x1:t,y1:e,x2:i,y2:s}:new K(t).toLine(),this.attr(t))}size(t,e){const i=ot(this,t,e);return this.attr(this.array().size(i.width,i.height).toLine())}}_(Dt,qe),y({Container:{line:O(function(...n){return Dt.prototype.plot.apply(this.put(new Dt),null!=n[0]?n:[0,0,0,0])})}}),x(Dt,"Line");class re extends Z{constructor(t,e=t){super(E("marker",t),e)}height(t){return this.attr("markerHeight",t)}orient(t){return this.attr("orient",t)}ref(t,e){return this.attr("refX",t).attr("refY",e)}toString(){return"url(#"+this.id()+")"}update(t){return this.clear(),"function"==typeof t&&t.call(this,this),this}width(t){return this.attr("markerWidth",t)}}function Mt(n,t){return function(e){return null==e?this[n]:(this[n]=e,t&&t.call(this),this)}}y({Container:{marker(...n){return this.defs().marker(...n)}},Defs:{marker:O(function(n,t,e){return this.put(new re).size(n,t).ref(n/2,t/2).viewbox(0,0,n,t).attr("orient","auto").update(e)})},marker:{marker(n,t,e,i){let s=["marker"];return"all"!==n&&s.push(n),s=s.join("-"),n=arguments[1]instanceof re?arguments[1]:this.defs().marker(t,e,i),this.attr(s,n)}}}),x(re,"Marker");const Rs={"-":function(n){return n},"<>":function(n){return-Math.cos(n*Math.PI)/2+.5},">":function(n){return Math.sin(n*Math.PI/2)},"<":function(n){return 1-Math.cos(n*Math.PI/2)},bezier:function(n,t,e,i){return function(s){return s<0?n>0?t/n*s:e>0?i/e*s:0:s>1?e<1?(1-i)/(1-e)*s+(i-e)/(1-e):n<1?(1-t)/(1-n)*s+(t-n)/(1-n):1:3*s*(1-s)**2*t+3*s**2*(1-s)*i+s**3}},steps:function(n,t="end"){t=t.split("-").reverse()[0];let e=n;return"none"===t?--e:"both"===t&&++e,(i,s=!1)=>{let r=Math.floor(i*n);const a=i*r%1==0;return("start"===t||"both"===t)&&++r,s&&a&&--r,i>=0&&r<0&&(r=0),i<=1&&r>e&&(r=e),r/e}}};class Pe{done(){return!1}}class Re extends Pe{constructor(t=vt_ease){super(),this.ease=Rs[t]||t}step(t,e,i){return"number"!=typeof t?i<1?t:e:t+(e-t)*this.ease(i)}}class oe extends Pe{constructor(t){super(),this.stepper=t}done(t){return t.done}step(t,e,i,s){return this.stepper(t,e,i,s)}}function $n(){const n=(this._duration||500)/1e3,i=Math.PI,s=Math.log((this._overshoot||0)/100+1e-10),r=-s/Math.sqrt(i*i+s*s),a=3.9/(r*n);this.d=2*r*a,this.k=a*a}_(class Zs extends oe{constructor(t=500,e=0){super(),this.duration(t).overshoot(e)}step(t,e,i,s){if("string"==typeof t)return t;if(s.done=i===1/0,i===1/0)return e;if(0===i)return t;i>100&&(i=16);const r=s.velocity||0,a=-this.d*r-this.k*(t-e),h=t+r*(i/=1e3)+a*i*i/2;return s.velocity=r+a*i,s.done=Math.abs(e-h)+Math.abs(r)<.002,s.done?e:h}},{duration:Mt("_duration",$n),overshoot:Mt("_overshoot",$n)}),_(class zs extends oe{constructor(t=.1,e=.01,i=0,s=1e3){super(),this.p(t).i(e).d(i).windup(s)}step(t,e,i,s){if("string"==typeof t)return t;if(s.done=i===1/0,i===1/0)return e;if(0===i)return t;const r=e-t;let a=(s.integral||0)+r*i;const h=(r-(s.error||0))/i,u=this._windup;return!1!==u&&(a=Math.max(-u,Math.min(a,u))),s.error=r,s.integral=a,s.done=Math.abs(r)<.001,s.done?e:t+(this.P*r+this.I*a+this.D*h)}},{windup:Mt("_windup"),p:Mt("P"),i:Mt("I"),d:Mt("D")});const Ls={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},Ze={M:function(n,t,e){return t.x=e.x=n[0],t.y=e.y=n[1],["M",t.x,t.y]},L:function(n,t){return t.x=n[0],t.y=n[1],["L",n[0],n[1]]},H:function(n,t){return t.x=n[0],["H",n[0]]},V:function(n,t){return t.y=n[0],["V",n[0]]},C:function(n,t){return t.x=n[4],t.y=n[5],["C",n[0],n[1],n[2],n[3],n[4],n[5]]},S:function(n,t){return t.x=n[2],t.y=n[3],["S",n[0],n[1],n[2],n[3]]},Q:function(n,t){return t.x=n[2],t.y=n[3],["Q",n[0],n[1],n[2],n[3]]},T:function(n,t){return t.x=n[0],t.y=n[1],["T",n[0],n[1]]},Z:function(n,t,e){return t.x=e.x,t.y=e.y,["Z"]},A:function(n,t){return t.x=n[5],t.y=n[6],["A",n[0],n[1],n[2],n[3],n[4],n[5],n[6]]}},ze="mlhvqtcsaz".split("");for(let n=0,t=ze.length;n<t;++n)Ze[ze[n]]=function(e){return function(i,s,r){if("H"===e)i[0]=i[0]+s.x;else if("V"===e)i[0]=i[0]+s.y;else if("A"===e)i[5]=i[5]+s.x,i[6]=i[6]+s.y;else for(let a=0,h=i.length;a<h;++a)i[a]=i[a]+(a%2?s.y:s.x);return Ze[e](i,s,r)}}(ze[n].toUpperCase());function Le(n){return n.segment.length&&n.segment.length-1===Ls[n.segment[0].toUpperCase()]}function js(n,t){n.inNumber&&ut(n,!1);const e=ee.test(t);if(e)n.segment=[t];else{const i=n.lastCommand,s=i.toLowerCase(),r=i===s;n.segment=["m"===s?r?"l":"L":i]}return n.inSegment=!0,n.lastCommand=n.segment[0],e}function ut(n,t){if(!n.inNumber)throw new Error("Parser Error");n.number&&n.segment.push(parseFloat(n.number)),n.inNumber=t,n.number="",n.pointSeen=!1,n.hasExponent=!1,Le(n)&&Ye(n)}function Ye(n){n.inSegment=!1,n.absolute&&(n.segment=function Ys(n){return Ze[n.segment[0]](n.segment.slice(1),n.p,n.p0)}(n)),n.segments.push(n.segment)}function Hs(n){if(!n.segment.length)return!1;const t="A"===n.segment[0].toUpperCase(),e=n.segment.length;return t&&(4===e||5===e)}function Bs(n){return"E"===n.lastToken.toUpperCase()}class ct extends Ct{bbox(){return G().path.setAttribute("d",this.toString()),new D(G.nodes.path.getBBox())}move(t,e){const i=this.bbox();if(t-=i.x,e-=i.y,!isNaN(t)&&!isNaN(e))for(let s,r=this.length-1;r>=0;r--)s=this[r][0],"M"===s||"L"===s||"T"===s?(this[r][1]+=t,this[r][2]+=e):"H"===s?this[r][1]+=t:"V"===s?this[r][1]+=e:"C"===s||"S"===s||"Q"===s?(this[r][1]+=t,this[r][2]+=e,this[r][3]+=t,this[r][4]+=e,"C"===s&&(this[r][5]+=t,this[r][6]+=e)):"A"===s&&(this[r][6]+=t,this[r][7]+=e);return this}parse(t="M0 0"){return Array.isArray(t)&&(t=Array.prototype.concat.apply([],t).toString()),function Us(n,t=!0){let e=0,i="";const s={segment:[],inNumber:!1,number:"",lastToken:"",inSegment:!1,segments:[],pointSeen:!1,hasExponent:!1,absolute:t,p0:new N,p:new N};for(;s.lastToken=i,i=n.charAt(e++);)if(s.inSegment||!js(s,i)){if("."===i){if(s.pointSeen||s.hasExponent){ut(s,!1),--e;continue}s.inNumber=!0,s.pointSeen=!0,s.number+=i;continue}if(!isNaN(parseInt(i))){if("0"===s.number||Hs(s)){s.inNumber=!0,s.number=i,ut(s,!0);continue}s.inNumber=!0,s.number+=i;continue}if(" "===i||","===i){s.inNumber&&ut(s,!1);continue}if("-"===i){if(s.inNumber&&!Bs(s)){ut(s,!1),--e;continue}s.number+=i,s.inNumber=!0;continue}if("E"===i.toUpperCase()){s.number+=i,s.hasExponent=!0;continue}if(ee.test(i)){if(s.inNumber)ut(s,!1);else{if(!Le(s))throw new Error("parser Error");Ye(s)}--e}}return s.inNumber&&ut(s,!1),s.inSegment&&Le(s)&&Ye(s),s.segments}(t)}size(t,e){const i=this.bbox();let s,r;for(i.width=0===i.width?1:i.width,i.height=0===i.height?1:i.height,s=this.length-1;s>=0;s--)r=this[s][0],"M"===r||"L"===r||"T"===r?(this[s][1]=(this[s][1]-i.x)*t/i.width+i.x,this[s][2]=(this[s][2]-i.y)*e/i.height+i.y):"H"===r?this[s][1]=(this[s][1]-i.x)*t/i.width+i.x:"V"===r?this[s][1]=(this[s][1]-i.y)*e/i.height+i.y:"C"===r||"S"===r||"Q"===r?(this[s][1]=(this[s][1]-i.x)*t/i.width+i.x,this[s][2]=(this[s][2]-i.y)*e/i.height+i.y,this[s][3]=(this[s][3]-i.x)*t/i.width+i.x,this[s][4]=(this[s][4]-i.y)*e/i.height+i.y,"C"===r&&(this[s][5]=(this[s][5]-i.x)*t/i.width+i.x,this[s][6]=(this[s][6]-i.y)*e/i.height+i.y)):"A"===r&&(this[s][1]=this[s][1]*t/i.width,this[s][2]=this[s][2]*e/i.height,this[s][6]=(this[s][6]-i.x)*t/i.width+i.x,this[s][7]=(this[s][7]-i.y)*e/i.height+i.y);return this}toString(){return function Fs(n){let t="";for(let e=0,i=n.length;e<i;e++)t+=n[e][0],null!=n[e][1]&&(t+=n[e][1],null!=n[e][2]&&(t+=" ",t+=n[e][2],null!=n[e][3]&&(t+=" ",t+=n[e][3],t+=" ",t+=n[e][4],null!=n[e][5]&&(t+=" ",t+=n[e][5],t+=" ",t+=n[e][6],null!=n[e][7]&&(t+=" ",t+=n[e][7])))));return t+" "}(this)}}const Jn=n=>{const t=typeof n;return"number"===t?m:"string"===t?k.isColor(n)?k:Q.test(n)?ee.test(n)?ct:Ct:Ce.test(n)?m:je:He.indexOf(n.constructor)>-1?n.constructor:Array.isArray(n)?Ct:"object"===t?qt:je};class lt{constructor(t){this._stepper=t||new Re("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}at(t){return this._morphObj.morph(this._from,this._to,t,this._stepper,this._context)}done(){return this._context.map(this._stepper.done).reduce(function(e,i){return e&&i},!0)}from(t){return null==t?this._from:(this._from=this._set(t),this)}stepper(t){return null==t?this._stepper:(this._stepper=t,this)}to(t){return null==t?this._to:(this._to=this._set(t),this)}type(t){return null==t?this._type:(this._type=t,this)}_set(t){this._type||this.type(Jn(t));let e=new this._type(t);return this._type===k&&(e=this._to?e[this._to[4]]():this._from?e[this._from[4]]():e),this._type===qt&&(e=this._to?e.align(this._to):this._from?e.align(this._from):e),e=e.toConsumable(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(e.length)).map(Object).map(function(i){return i.done=!0,i}),e}}class je{constructor(...t){this.init(...t)}init(t){return t=Array.isArray(t)?t[0]:t,this.value=t,this}toArray(){return[this.value]}valueOf(){return this.value}}let Xn=(()=>{class n{constructor(...e){this.init(...e)}init(e){return Array.isArray(e)&&(e={scaleX:e[0],scaleY:e[1],shear:e[2],rotate:e[3],translateX:e[4],translateY:e[5],originX:e[6],originY:e[7]}),Object.assign(this,n.defaults,e),this}toArray(){const e=this;return[e.scaleX,e.scaleY,e.shear,e.rotate,e.translateX,e.translateY,e.originX,e.originY]}}return n.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0},n})();const $s=(n,t)=>n[0]<t[0]?-1:n[0]>t[0]?1:0;class qt{constructor(...t){this.init(...t)}align(t){const e=this.values;for(let i=0,s=e.length;i<s;++i){if(e[i+1]===t[i+1]){if(e[i+1]===k&&t[i+7]!==e[i+7]){const h=t[i+7],u=new k(this.values.splice(i+3,5))[h]().toArray();this.values.splice(i+3,0,...u)}i+=e[i+2]+2;continue}if(!t[i+1])return this;const r=(new t[i+1]).toArray();e.splice(i,e[i+2]+3,t[i],t[i+1],t[i+2],...r),i+=e[i+2]+2}return this}init(t){if(this.values=[],Array.isArray(t))return void(this.values=t.slice());t=t||{};const e=[];for(const i in t){const s=Jn(t[i]),r=new s(t[i]).toArray();e.push([i,s,r.length,...r])}return e.sort($s),this.values=e.reduce((i,s)=>i.concat(s),[]),this}toArray(){return this.values}valueOf(){const t={},e=this.values;for(;e.length;){const i=e.shift(),s=e.shift(),r=e.shift(),a=e.splice(0,r);t[i]=new s(a)}return t}}const He=[je,Xn,qt];class Tt extends Y{constructor(t,e=t){super(E("path",t),e)}array(){return this._array||(this._array=new ct(this.attr("d")))}clear(){return delete this._array,this}height(t){return null==t?this.bbox().height:this.size(this.bbox().width,t)}move(t,e){return this.attr("d",this.array().move(t,e))}plot(t){return null==t?this.array():this.clear().attr("d","string"==typeof t?t:this._array=new ct(t))}size(t,e){const i=ot(this,t,e);return this.attr("d",this.array().size(i.width,i.height))}width(t){return null==t?this.bbox().width:this.size(t,this.bbox().height)}x(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)}y(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)}}Tt.prototype.MorphArray=ct,y({Container:{path:O(function(n){return this.put(new Tt).plot(n||new ct)})}}),x(Tt,"Path");var Qn={__proto__:null,array:function Qs(){return this._array||(this._array=new K(this.attr("points")))},clear:function Ws(){return delete this._array,this},move:function Gs(n,t){return this.attr("points",this.array().move(n,t))},plot:function Vs(n){return null==n?this.array():this.clear().attr("points","string"==typeof n?n:this._array=new K(n))},size:function Ks(n,t){const e=ot(this,n,t);return this.attr("points",this.array().size(e.width,e.height))}};class Pt extends Y{constructor(t,e=t){super(E("polygon",t),e)}}y({Container:{polygon:O(function(n){return this.put(new Pt).plot(n||new K)})}}),_(Pt,qe),_(Pt,Qn),x(Pt,"Polygon");class Rt extends Y{constructor(t,e=t){super(E("polyline",t),e)}}y({Container:{polyline:O(function(n){return this.put(new Rt).plot(n||new K)})}}),_(Rt,qe),_(Rt,Qn),x(Rt,"Polyline");class ae extends Y{constructor(t,e=t){super(E("rect",t),e)}}_(ae,{rx:Ne,ry:De}),y({Container:{rect:O(function(n,t){return this.put(new ae).size(n,t)})}}),x(ae,"Rect");class Be{constructor(){this._first=null,this._last=null}first(){return this._first&&this._first.value}last(){return this._last&&this._last.value}push(t){const e=typeof t.next<"u"?t:{value:t,next:null,prev:null};return this._last?(e.prev=this._last,this._last.next=e,this._last=e):(this._last=e,this._first=e),e}remove(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t===this._last&&(this._last=t.prev),t===this._first&&(this._first=t.next),t.prev=null,t.next=null}shift(){const t=this._first;return t?(this._first=t.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,t.value):null}}const M={nextDraw:null,frames:new Be,timeouts:new Be,immediates:new Be,timer:()=>w.window.performance||w.window.Date,transforms:[],frame(n){const t=M.frames.push({run:n});return null===M.nextDraw&&(M.nextDraw=w.window.requestAnimationFrame(M._draw)),t},timeout(n,t){t=t||0;const e=M.timer().now()+t,i=M.timeouts.push({run:n,time:e});return null===M.nextDraw&&(M.nextDraw=w.window.requestAnimationFrame(M._draw)),i},immediate(n){const t=M.immediates.push(n);return null===M.nextDraw&&(M.nextDraw=w.window.requestAnimationFrame(M._draw)),t},cancelFrame(n){null!=n&&M.frames.remove(n)},clearTimeout(n){null!=n&&M.timeouts.remove(n)},cancelImmediate(n){null!=n&&M.immediates.remove(n)},_draw(n){let t=null;const e=M.timeouts.last();for(;(t=M.timeouts.shift())&&(n>=t.time?t.run():M.timeouts.push(t),t!==e););let i=null;const s=M.frames.last();for(;i!==s&&(i=M.frames.shift());)i.run(n);let r=null;for(;r=M.immediates.shift();)r();M.nextDraw=M.timeouts.first()||M.frames.first()?w.window.requestAnimationFrame(M._draw):null}},tr=function(n){const t=n.start,e=n.runner.duration();return{start:t,duration:e,end:t+e,runner:n.runner}},er=function(){const n=w.window;return(n.performance||n.Date).now()};class Wn extends Ot{constructor(t=er){super(),this._timeSource=t,this._startTime=0,this._speed=1,this._persist=0,this._nextFrame=null,this._paused=!0,this._runners=[],this._runnerIds=[],this._lastRunnerId=-1,this._time=0,this._lastSourceTime=0,this._lastStepTime=0,this._step=this._stepFn.bind(this,!1),this._stepImmediate=this._stepFn.bind(this,!0)}active(){return!!this._nextFrame}finish(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}getEndTime(){const t=this.getLastRunnerInfo(),e=t?t.runner.duration():0;return(t?t.start:this._time)+e}getEndTimeOfTimeline(){const t=this._runners.map(e=>e.start+e.runner.duration());return Math.max(0,...t)}getLastRunnerInfo(){return this.getRunnerInfoById(this._lastRunnerId)}getRunnerInfoById(t){return this._runners[this._runnerIds.indexOf(t)]||null}pause(){return this._paused=!0,this._continue()}persist(t){return null==t?this._persist:(this._persist=t,this)}play(){return this._paused=!1,this.updateTime()._continue()}reverse(t){const e=this.speed();if(null==t)return this.speed(-e);const i=Math.abs(e);return this.speed(t?-i:i)}schedule(t,e,i){if(null==t)return this._runners.map(tr);let s=0;const r=this.getEndTime();if(e=e||0,null==i||"last"===i||"after"===i)s=r;else if("absolute"===i||"start"===i)s=e,e=0;else if("now"===i)s=this._time;else if("relative"===i){const u=this.getRunnerInfoById(t.id);u&&(s=u.start+e,e=0)}else{if("with-last"!==i)throw new Error('Invalid value for the "when" parameter');{const u=this.getLastRunnerInfo();s=u?u.start:this._time}}t.unschedule(),t.timeline(this);const a=t.persist(),h={persist:null===a?this._persist:a,start:s+e,runner:t};return this._lastRunnerId=t.id,this._runners.push(h),this._runners.sort((u,c)=>u.start-c.start),this._runnerIds=this._runners.map(u=>u.runner.id),this.updateTime()._continue(),this}seek(t){return this.time(this._time+t)}source(t){return null==t?this._timeSource:(this._timeSource=t,this)}speed(t){return null==t?this._speed:(this._speed=t,this)}stop(){return this.time(0),this.pause()}time(t){return null==t?this._time:(this._time=t,this._continue(!0))}unschedule(t){const e=this._runnerIds.indexOf(t.id);return e<0||(this._runners.splice(e,1),this._runnerIds.splice(e,1),t.timeline(null)),this}updateTime(){return this.active()||(this._lastSourceTime=this._timeSource()),this}_continue(t=!1){return M.cancelFrame(this._nextFrame),this._nextFrame=null,t?this._stepImmediate():(this._paused||(this._nextFrame=M.frame(this._step)),this)}_stepFn(t=!1){const e=this._timeSource();let i=e-this._lastSourceTime;t&&(i=0);const s=this._speed*i+(this._time-this._lastStepTime);this._lastSourceTime=e,t||(this._time+=s,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(let a=this._runners.length;a--;){const h=this._runners[a],u=h.runner;this._time-h.start<=0&&u.reset()}let r=!1;for(let a=0,h=this._runners.length;a<h;a++){const u=this._runners[a],c=u.runner;let l=s;const f=this._time-u.start;f<=0?r=!0:(f<l&&(l=f),c.active()&&(c.step(l).done?!0!==u.persist&&c.duration()-c.time()+this._time+u.persist<this._time&&(c.unschedule(),--a,--h):r=!0))}return r&&!(this._speed<0&&0===this._time)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}}y({Element:{timeline:function(n){return null==n?(this._timeline=this._timeline||new Wn,this._timeline):(this._timeline=n,this)}}});let tt=(()=>{class n extends Ot{constructor(e){super(),this.id=n.id++,e="function"==typeof(e=e??vt_duration)?new oe(e):e,this._element=null,this._timeline=null,this.done=!1,this._queue=[],this._duration="number"==typeof e&&e,this._isDeclarative=e instanceof oe,this._stepper=this._isDeclarative?e:new Re,this._history={},this.enabled=!0,this._time=0,this._lastTime=0,this._reseted=!0,this.transforms=new d,this.transformId=1,this._haveReversed=!1,this._reverse=!1,this._loopsDone=0,this._swing=!1,this._wait=0,this._times=1,this._frameId=null,this._persist=!!this._isDeclarative||null}static sanitise(e,i,s){let r=1,a=!1,h=0;return i=i||vt_delay,s=s||"last","object"==typeof(e=e||vt_duration)&&!(e instanceof Pe)&&(i=e.delay||i,s=e.when||s,a=e.swing||a,r=e.times||r,h=e.wait||h,e=e.duration||vt_duration),{duration:e,delay:i,swing:a,times:r,wait:h,when:s}}active(e){return null==e?this.enabled:(this.enabled=e,this)}addTransform(e,i){return this.transforms.lmultiplyO(e),this}after(e){return this.on("finished",e)}animate(e,i,s){const r=n.sanitise(e,i,s),a=new n(r.duration);return this._timeline&&a.timeline(this._timeline),this._element&&a.element(this._element),a.loop(r).schedule(r.delay,r.when)}clearTransform(){return this.transforms=new d,this}clearTransformsFromQueue(){(!this.done||!this._timeline||!this._timeline._runnerIds.includes(this.id))&&(this._queue=this._queue.filter(e=>!e.isTransform))}delay(e){return this.animate(0,e)}duration(){return this._times*(this._wait+this._duration)-this._wait}during(e){return this.queue(null,e)}ease(e){return this._stepper=new Re(e),this}element(e){return null==e?this._element:(this._element=e,e._prepareRunner(),this)}finish(){return this.step(1/0)}loop(e,i,s){return"object"==typeof e&&(i=e.swing,s=e.wait,e=e.times),this._times=e||1/0,this._swing=i||!1,this._wait=s||0,!0===this._times&&(this._times=1/0),this}loops(e){const i=this._duration+this._wait;if(null==e){const h=Math.floor(this._time/i);return Math.min(h+(this._time-h*i)/this._duration,this._times)}const s=Math.floor(e);return this.time(i*s+this._duration*(e%1))}persist(e){return null==e?this._persist:(this._persist=e,this)}position(e){const i=this._time,s=this._duration,r=this._wait,h=this._swing,u=this._reverse;let c;if(null==e){const b=function(v){const T=h*Math.floor(v%(2*(r+s))/(r+s)),I=T&&!u||!T&&u,q=Math.pow(-1,I)*(v%(r+s))/s+I;return Math.max(Math.min(q,1),0)},C=this._times*(r+s)-r;return c=i<=0?Math.round(b(1e-5)):i<C?b(i):Math.round(b(C-1e-5)),c}const l=Math.floor(this.loops()),f=h&&l%2==0;return c=l+(f&&!u||u&&f?e:1-e),this.loops(c)}progress(e){return null==e?Math.min(1,this._time/this.duration()):this.time(e*this.duration())}queue(e,i,s,r){return this._queue.push({initialiser:e||Se,runner:i||Se,retarget:s,isTransform:r,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}reset(){return this._reseted||(this.time(0),this._reseted=!0),this}reverse(e){return this._reverse=e??!this._reverse,this}schedule(e,i,s){if(e instanceof Wn||(s=i,i=e,e=this.timeline()),!e)throw Error("Runner cannot be scheduled without timeline");return e.schedule(this,i,s),this}step(e){if(!this.enabled)return this;this._time+=e=e??16;const i=this.position(),s=this._lastPosition!==i&&this._time>=0;this._lastPosition=i;const r=this.duration(),a=this._lastTime<=0&&this._time>0,h=this._lastTime<r&&this._time>=r;this._lastTime=this._time,a&&this.fire("start",this);const u=this._isDeclarative;this.done=!u&&!h&&this._time>=r,this._reseted=!1;let c=!1;return(s||u)&&(this._initialise(s),this.transforms=new d,c=this._run(u?e:i),this.fire("step",this)),this.done=this.done||c&&u,h&&this.fire("finished",this),this}time(e){return null==e?this._time:(this.step(e-this._time),this)}timeline(e){return typeof e>"u"?this._timeline:(this._timeline=e,this)}unschedule(){const e=this.timeline();return e&&e.unschedule(this),this}_initialise(e){if(e||this._isDeclarative)for(let i=0,s=this._queue.length;i<s;++i){const r=this._queue[i],a=this._isDeclarative||!r.initialised&&e;e=!r.finished,a&&e&&(r.initialiser.call(this),r.initialised=!0)}}_rememberMorpher(e,i){if(this._history[e]={morpher:i,caller:this._queue[this._queue.length-1]},this._isDeclarative){const s=this.timeline();s&&s.play()}}_run(e){let i=!0;for(let s=0,r=this._queue.length;s<r;++s){const a=this._queue[s],h=a.runner.call(this,e);a.finished=a.finished||!0===h,i=i&&a.finished}return i}_tryRetarget(e,i,s){if(this._history[e]){if(!this._history[e].caller.initialised){const a=this._queue.indexOf(this._history[e].caller);return this._queue.splice(a,1),!1}this._history[e].caller.retarget?this._history[e].caller.retarget.call(this,i,s):this._history[e].morpher.to(i),this._history[e].caller.finished=!1;const r=this.timeline();return r&&r.play(),!0}return!1}}return n.id=0,n})();class he{constructor(t=new d,e=-1,i=!0){this.transforms=t,this.id=e,this.done=i}clearTransformsFromQueue(){}}_([tt,he],{mergeWith(n){return new he(n.transforms.lmultiply(this.transforms),n.id)}});const Gn=(n,t)=>n.lmultiplyO(t),Vn=n=>n.transforms;function nr(){const t=this._transformationRunners.runners.map(Vn).reduce(Gn,new d);this.transform(t),this._transformationRunners.merge(),1===this._transformationRunners.length()&&(this._frameId=null)}class ir{constructor(){this.runners=[],this.ids=[]}add(t){if(this.runners.includes(t))return;const e=t.id+1;return this.runners.push(t),this.ids.push(e),this}clearBefore(t){const e=this.ids.indexOf(t+1)||1;return this.ids.splice(0,e,0),this.runners.splice(0,e,new he).forEach(i=>i.clearTransformsFromQueue()),this}edit(t,e){const i=this.ids.indexOf(t+1);return this.ids.splice(i,1,t+1),this.runners.splice(i,1,e),this}getByID(t){return this.runners[this.ids.indexOf(t+1)]}length(){return this.ids.length}merge(){let t=null;for(let e=0;e<this.runners.length;++e){const i=this.runners[e];if(!(t&&i.done&&t.done)||i._timeline&&i._timeline._runnerIds.includes(i.id)||t._timeline&&t._timeline._runnerIds.includes(t.id))t=i;else{this.remove(i.id);const r=i.mergeWith(t);this.edit(t.id,r),t=r,--e}}return this}remove(t){const e=this.ids.indexOf(t+1);return this.ids.splice(e,1),this.runners.splice(e,1),this}}y({Element:{animate(n,t,e){const i=tt.sanitise(n,t,e),s=this.timeline();return new tt(i.duration).loop(i).element(this).timeline(s.play()).schedule(i.delay,i.when)},delay(n,t){return this.animate(0,n,t)},_clearTransformRunnersBefore(n){this._transformationRunners.clearBefore(n.id)},_currentTransform(n){return this._transformationRunners.runners.filter(t=>t.id<=n.id).map(Vn).reduce(Gn,new d)},_addRunner(n){this._transformationRunners.add(n),M.cancelImmediate(this._frameId),this._frameId=M.immediate(nr.bind(this))},_prepareRunner(){null==this._frameId&&(this._transformationRunners=(new ir).add(new he(new d(this))))}}}),_(tt,{attr(n,t){return this.styleAttr("attr",n,t)},css(n,t){return this.styleAttr("css",n,t)},styleAttr(n,t,e){if("string"==typeof t)return this.styleAttr(n,{[t]:e});let i=t;if(this._tryRetarget(n,i))return this;let s=new lt(this._stepper).to(i),r=Object.keys(i);return this.queue(function(){s=s.from(this.element()[n](r))},function(a){return this.element()[n](s.at(a).valueOf()),s.done()},function(a){const h=Object.keys(a),u=((n,t)=>n.filter(e=>!t.includes(e)))(h,r);if(u.length){const l=this.element()[n](u),f=new qt(s.from()).valueOf();Object.assign(f,l),s.from(f)}const c=new qt(s.to()).valueOf();Object.assign(c,a),s.to(c),r=h,i=a}),this._rememberMorpher(n,s),this},zoom(n,t){if(this._tryRetarget("zoom",n,t))return this;let e=new lt(this._stepper).to(new m(n));return this.queue(function(){e=e.from(this.element().zoom())},function(i){return this.element().zoom(e.at(i),t),e.done()},function(i,s){t=s,e.to(i)}),this._rememberMorpher("zoom",e),this},transform(n,t,e){if(t=n.relative||t,this._isDeclarative&&!t&&this._tryRetarget("transform",n))return this;const i=d.isMatrixLike(n);e=null!=n.affine?n.affine:e??!i;const s=new lt(this._stepper).type(e?Xn:d);let r,a,h,u,c;return this.queue(function l(){a=a||this.element(),r=r||Gt(n,a),c=new d(t?void 0:a),a._addRunner(this),t||a._clearTransformRunnersBefore(this)},function f(b){t||this.clearTransform();const{x:C,y:v}=new N(r).transform(a._currentTransform(this));let T=new d({...n,origin:[C,v]}),I=this._isDeclarative&&h?h:c;if(e){T=T.decompose(C,v),I=I.decompose(C,v);const U=T.rotate,it=I.rotate,st=[U-360,U,U+360],dt=st.map(To=>Math.abs(To-it)),ge=Math.min(...dt),ye=dt.indexOf(ge);T.rotate=st[ye]}t&&(i||(T.rotate=n.rotate||0),this._isDeclarative&&u&&(I.rotate=u)),s.from(I),s.to(T);const q=s.at(b);return u=q.rotate,h=new d(q),this.addTransform(h),a._addRunner(this),s.done()},function g(b){(b.origin||"center").toString()!==(n.origin||"center").toString()&&(r=Gt(b,a)),n={...b,origin:r}},!0),this._isDeclarative&&this._rememberMorpher("transform",s),this},x(n,t){return this._queueNumber("x",n)},y(n){return this._queueNumber("y",n)},dx(n=0){return this._queueNumberDelta("x",n)},dy(n=0){return this._queueNumberDelta("y",n)},dmove(n,t){return this.dx(n).dy(t)},_queueNumberDelta(n,t){if(t=new m(t),this._tryRetarget(n,t))return this;const e=new lt(this._stepper).to(t);let i=null;return this.queue(function(){i=this.element()[n](),e.from(i),e.to(i+t)},function(s){return this.element()[n](e.at(s)),e.done()},function(s){e.to(i+new m(s))}),this._rememberMorpher(n,e),this},_queueObject(n,t){if(this._tryRetarget(n,t))return this;const e=new lt(this._stepper).to(t);return this.queue(function(){e.from(this.element()[n]())},function(i){return this.element()[n](e.at(i)),e.done()}),this._rememberMorpher(n,e),this},_queueNumber(n,t){return this._queueObject(n,new m(t))},cx(n){return this._queueNumber("cx",n)},cy(n){return this._queueNumber("cy",n)},move(n,t){return this.x(n).y(t)},center(n,t){return this.cx(n).cy(t)},size(n,t){let e;return(!n||!t)&&(e=this._element.bbox()),n||(n=e.width/e.height*t),t||(t=e.height/e.width*n),this.width(n).height(t)},width(n){return this._queueNumber("width",n)},height(n){return this._queueNumber("height",n)},plot(n,t,e,i){if(4===arguments.length)return this.plot([n,t,e,i]);if(this._tryRetarget("plot",n))return this;const s=new lt(this._stepper).type(this._element.MorphArray).to(n);return this.queue(function(){s.from(this._element.array())},function(r){return this._element.plot(s.at(r)),s.done()}),this._rememberMorpher("plot",s),this},leading(n){return this._queueNumber("leading",n)},viewbox(n,t,e,i){return this._queueObject("viewbox",new D(n,t,e,i))},update(n){return"object"!=typeof n?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(null!=n.opacity&&this.attr("stop-opacity",n.opacity),null!=n.color&&this.attr("stop-color",n.color),null!=n.offset&&this.attr("offset",n.offset),this)}}),_(tt,{rx:Ne,ry:De,from:Un,to:Fn}),x(tt,"Runner");class Ue extends Z{constructor(t,e=t){super(E("svg",t),e),this.namespace()}defs(){return this.isRoot()?L(this.node.querySelector("defs"))||this.put(new ne):this.root().defs()}isRoot(){return!this.node.parentNode||!(this.node.parentNode instanceof w.window.SVGElement)&&"#document-fragment"!==this.node.parentNode.nodeName}namespace(){return this.isRoot()?this.attr({xmlns:Vt,version:"1.1"}).attr("xmlns:xlink",yt,At).attr("xmlns:svgjs","http://svgjs.dev/svgjs",At):this.root().namespace()}removeNamespace(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,At).attr("xmlns:svgjs",null,At)}root(){return this.isRoot()?this:super.root()}}y({Container:{nested:O(function(){return this.put(new Ue)})}}),x(Ue,"Svg",!0);class Fe extends Z{constructor(t,e=t){super(E("symbol",t),e)}}y({Container:{symbol:O(function(){return this.put(new Fe)})}}),x(Fe,"Symbol");var Kn={__proto__:null,plain:function rr(n){return!1===this._build&&this.clear(),this.node.appendChild(w.document.createTextNode(n)),this},length:function or(){return this.node.getComputedTextLength()},x:function ar(n,t=this.bbox()){return null==n?t.x:this.attr("x",this.attr("x")+n-t.x)},y:function hr(n,t=this.bbox()){return null==n?t.y:this.attr("y",this.attr("y")+n-t.y)},move:function ur(n,t,e=this.bbox()){return this.x(n,e).y(t,e)},cx:function cr(n,t=this.bbox()){return null==n?t.cx:this.attr("x",this.attr("x")+n-t.cx)},cy:function lr(n,t=this.bbox()){return null==n?t.cy:this.attr("y",this.attr("y")+n-t.cy)},center:function fr(n,t,e=this.bbox()){return this.cx(n,e).cy(t,e)},ax:function dr(n){return this.attr("x",n)},ay:function pr(n){return this.attr("y",n)},amove:function mr(n,t){return this.ax(n).ay(t)},build:function gr(n){return this._build=!!n,this}};class F extends Y{constructor(t,e=t){super(E("text",t),e),this.dom.leading=new m(1.3),this._rebuild=!0,this._build=!1}leading(t){return null==t?this.dom.leading:(this.dom.leading=new m(t),this.rebuild())}rebuild(t){if("boolean"==typeof t&&(this._rebuild=t),this._rebuild){const e=this;let i=0;const s=this.dom.leading;this.each(function(r){const a=w.window.getComputedStyle(this.node).getPropertyValue("font-size"),h=s*new m(a);this.dom.newLined&&(this.attr("x",e.attr("x")),"\n"===this.text()?i+=h:(this.attr("dy",r?h+i:0),i=0))}),this.fire("rebuild")}return this}setData(t){return this.dom=t,this.dom.leading=new m(t.leading||1.3),this}text(t){if(void 0===t){const e=this.node.childNodes;let i=0;t="";for(let s=0,r=e.length;s<r;++s)"textPath"!==e[s].nodeName?(s!==i&&3!==e[s].nodeType&&!0===L(e[s]).dom.newLined&&(t+="\n"),t+=e[s].textContent):0===s&&(i=1);return t}if(this.clear().build(!0),"function"==typeof t)t.call(this,this);else for(let e=0,i=(t=(t+"").split("\n")).length;e<i;e++)this.newLine(t[e]);return this.build(!1).rebuild()}}_(F,Kn),y({Container:{text:O(function(n=""){return this.put(new F).text(n)}),plain:O(function(n=""){return this.put(new F).plain(n)})}}),x(F,"Text");class ue extends Y{constructor(t,e=t){super(E("tspan",t),e),this._build=!1}dx(t){return this.attr("dx",t)}dy(t){return this.attr("dy",t)}newLine(){this.dom.newLined=!0;const t=this.parent();if(!(t instanceof F))return this;const e=t.index(this),i=w.window.getComputedStyle(this.node).getPropertyValue("font-size"),s=t.dom.leading*new m(i);return this.dy(e?s:0).attr("x",t.x())}text(t){return null==t?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof t?(this.clear().build(!0),t.call(this,this),this.build(!1)):this.plain(t),this)}}_(ue,Kn),y({Tspan:{tspan:O(function(n=""){const t=new ue;return this._build||this.clear(),this.put(t).text(n)})},Text:{newLine:function(n=""){return this.tspan(n).newLine()}}}),x(ue,"Tspan");class $e extends Y{constructor(t,e=t){super(E("circle",t),e)}radius(t){return this.attr("r",t)}rx(t){return this.attr("r",t)}ry(t){return this.rx(t)}size(t){return this.radius(new m(t).divide(2))}}_($e,{x:Zn,y:zn,cx:Ln,cy:Yn,width:jn,height:Hn}),y({Container:{circle:O(function(n=0){return this.put(new $e).size(n).move(0,0)})}}),x($e,"Circle");class Je extends Z{constructor(t,e=t){super(E("clipPath",t),e)}remove(){return this.targets().forEach(function(t){t.unclip()}),super.remove()}targets(){return xt('svg [clip-path*="'+this.id()+'"]')}}y({Container:{clip:O(function(){return this.defs().put(new Je)})},Element:{clipper(){return this.reference("clip-path")},clipWith(n){const t=n instanceof Je?n:this.parent().clip().add(n);return this.attr("clip-path",'url("#'+t.id()+'")')},unclip(){return this.attr("clip-path",null)}}}),x(Je,"ClipPath");class ti extends W{constructor(t,e=t){super(E("foreignObject",t),e)}}y({Container:{foreignObject:O(function(n,t){return this.put(new ti).size(n,t)})}}),x(ti,"ForeignObject");var ei={__proto__:null,dmove:function yr(n,t){return this.children().forEach((e,i)=>{let s;try{s=e.bbox()}catch{return}const r=new d(e),a=r.translate(n,t).transform(r.inverse()),h=new N(s.x,s.y).transform(a);e.move(h.x,h.y)}),this},dx:function wr(n){return this.dmove(n,0)},dy:function _r(n){return this.dmove(0,n)},height:function xr(n,t=this.bbox()){return null==n?t.height:this.size(t.width,n,t)},move:function br(n=0,t=0,e=this.bbox()){return this.dmove(n-e.x,t-e.y)},size:function vr(n,t,e=this.bbox()){const i=ot(this,n,t,e),s=i.width/e.width,r=i.height/e.height;return this.children().forEach((a,h)=>{const u=new N(e).transform(new d(a).inverse());a.scale(s,r,u.x,u.y)}),this},width:function Cr(n,t=this.bbox()){return null==n?t.width:this.size(n,t.height,t)},x:function Mr(n,t=this.bbox()){return null==n?t.x:this.move(n,t.y,t)},y:function Tr(n,t=this.bbox()){return null==n?t.y:this.move(t.x,n,t)}};class Xe extends Z{constructor(t,e=t){super(E("g",t),e)}}_(Xe,ei),y({Container:{group:O(function(){return this.put(new Xe)})}}),x(Xe,"G");class ce extends Z{constructor(t,e=t){super(E("a",t),e)}target(t){return this.attr("target",t)}to(t){return this.attr("href",t,yt)}}_(ce,ei),y({Container:{link:O(function(n){return this.put(new ce).to(n)})},Element:{unlink(){const n=this.linker();if(!n)return this;const t=n.parent();if(!t)return this.remove();const e=t.index(n);return t.add(this,e),n.remove(),this},linkTo(n){let t=this.linker();return t||(t=new ce,this.wrap(t)),"function"==typeof n?n.call(t,t):t.to(n),this},linker(){const n=this.parent();return n&&"a"===n.node.nodeName.toLowerCase()?n:null}}}),x(ce,"A");class Qe extends Z{constructor(t,e=t){super(E("mask",t),e)}remove(){return this.targets().forEach(function(t){t.unmask()}),super.remove()}targets(){return xt('svg [mask*="'+this.id()+'"]')}}y({Container:{mask:O(function(){return this.defs().put(new Qe)})},Element:{masker(){return this.reference("mask")},maskWith(n){const t=n instanceof Qe?n:this.parent().mask().add(n);return this.attr("mask",'url("#'+t.id()+'")')},unmask(){return this.attr("mask",null)}}}),x(Qe,"Mask");class ni extends W{constructor(t,e=t){super(E("stop",t),e)}update(t){return("number"==typeof t||t instanceof m)&&(t={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",new m(t.offset)),this}}y({Gradient:{stop:function(n,t,e){return this.put(new ni).update(n,t,e)}}}),x(ni,"Stop");class We extends W{constructor(t,e=t){super(E("style",t),e)}addText(t=""){return this.node.textContent+=t,this}font(t,e,i={}){return this.rule("@font-face",{fontFamily:t,src:e,...i})}rule(t,e){return this.addText(function kr(n,t){if(!n)return"";if(!t)return n;let e=n+"{";for(const i in t)e+=xn(i)+":"+t[i]+";";return e+="}",e}(t,e))}}y("Dom",{style(n,t){return this.put(new We).rule(n,t)},fontface(n,t,e){return this.put(new We).font(n,t,e)}}),x(We,"Style");class Ge extends F{constructor(t,e=t){super(E("textPath",t),e)}array(){const t=this.track();return t?t.array():null}plot(t){const e=this.track();let i=null;return e&&(i=e.plot(t)),null==t?i:this}track(){return this.reference("href")}}y({Container:{textPath:O(function(n,t){return n instanceof F||(n=this.text(n)),n.path(t)})},Text:{path:O(function(n,t=!0){const e=new Ge;let i;if(n instanceof Tt||(n=this.defs().path(n)),e.attr("href","#"+n,yt),t)for(;i=this.node.firstChild;)e.node.appendChild(i);return this.put(e)}),textPath(){return this.findOne("textPath")}},Path:{text:O(function(n){return n instanceof F||(n=(new F).addTo(this.parent()).text(n)),n.path(this)}),targets(){return xt("svg textPath").filter(n=>(n.attr("href")||"").includes(this.id()))}}}),Ge.prototype.MorphArray=ct,x(Ge,"TextPath");class ii extends Y{constructor(t,e=t){super(E("use",t),e)}use(t,e){return this.attr("href",(e||"")+"#"+t,yt)}}y({Container:{use:O(function(n,t){return this.put(new ii).use(n,t)})}}),x(ii,"Use");const Ar=P;_([Ue,Fe,se,Nt,re],R("viewbox")),_([Dt,Rt,Pt,Tt],R("marker")),_(F,R("Text")),_(Tt,R("Path")),_(ne,R("Defs")),_([F,ue],R("Tspan")),_([ae,ie,St,tt],R("radius")),_(Ot,R("EventTarget")),_(V,R("Dom")),_(W,R("Element")),_(Y,R("Shape")),_([Z,Bn],R("Container")),_(St,R("Gradient")),_(tt,R("Runner")),ht.extend(function ki(){return[...new Set(yn)]}()),function Js(n=[]){He.push(...[].concat(n))}([m,k,D,d,Ct,K,ct,N]),function Xs(){_(He,{to(n){return(new lt).type(this.constructor).from(this.toArray()).to(n)},fromArray(n){return this.init(n),this},toConsumable(){return this.toArray()},morph(n,t,e,i,s){return this.fromArray(n.map(function(a,h){return i.step(a,t[h],e,s[h],s)}))}})}();const H=n=>Number.isFinite(n)&&!Number.isNaN(n),Zt=n=>"object"==typeof n&&null!==n,zt=n=>Zt(n)&&H(n.col)&&H(n.row),le=n=>Array.isArray(n)&&H(n[0])&&H(n[1]),fe=(n,t)=>t+n*(1&t)>>1,Sr=(n,t)=>function Ir(n,t){return(n%t+t)%t}(n+t,8),de=([n,t,e=-n-t])=>({q:n,r:t,s:e});function Lt({q:n,r:t,s:e}){const i=H(n),s=H(t),r=H(e);if(i&&s&&r)return{q:n,r:t,s:e};if(i&&s)return{q:n,r:t,s:-n-t};if(i&&r)return{q:n,r:-n-e,s:e};if(s&&r)return{q:-t-e,r:t,s:e};throw new TypeError(`Can't determine three cube coordinates from less than two coordinates. Received: { q: ${n}, r: ${t}, s: ${e} }.`)}var $=(n=>(n.FLAT="FLAT",n.POINTY="POINTY",n))($||{});class Ve{constructor(t=[0,0]){an(this,"q"),an(this,"r");const{q:e,r:i}=jt(this,t);this.q=e,this.r=i}static get settings(){const{dimensions:t,orientation:e,origin:i,offset:s}=this.prototype;return{dimensions:t,orientation:e,origin:i,offset:s}}get center(){const{width:t,height:e,x:i,y:s}=this;return{x:t/2-i,y:e/2-s}}get col(){return Ke(this).col}get corners(){const{orientation:t,width:e,height:i,x:s,y:r}=this;return t===$.POINTY?qr(e,i,s,r):Pr(e,i,s,r)}get dimensions(){return Yt.dimensions}get height(){const{orientation:t,dimensions:{yRadius:e}}=this;return t===$.POINTY?2*e:e*Math.sqrt(3)}get isFlat(){return this.orientation===$.FLAT}get isPointy(){return this.orientation===$.POINTY}get orientation(){return Yt.orientation}get origin(){return Yt.origin}get offset(){return Yt.offset}get row(){return Ke(this).row}get width(){const{orientation:t,dimensions:{xRadius:e}}=this;return t===$.POINTY?e*Math.sqrt(3):2*e}get x(){return tn(this).x}get y(){return tn(this).y}get s(){return-this.q-this.r}clone(t=this){return new this.constructor(t)}equals(t){return function Rr(n,t){if(zt(n)&&zt(t))return n.col===t.col&&n.row===t.row;if(Object.hasOwn(n,"col")||Object.hasOwn(t,"col"))throw new Error(`Can't compare coordinates where one are offset coordinates. Either pass two offset coordinates or two axial/cube coordinates. Received: ${JSON.stringify(n)} and ${JSON.stringify(t)}`);const e=le(n)?de(n):n,i=le(t)?de(t):t;return e.q===i.q&&e.r===i.r}(this,zt(t)?ai(this,t):t)}toString(){return`${this.constructor.name}(${this.q},${this.r})`}translate(t){return function Yr(n,t){const{q:e,r:i,s}=Lt(n),{q:r,r:a,s:h}=Lt(t),u={q:e+r,r:i+a,s:s+h};return n instanceof Ve?n.clone(u):u}(this,t)}}const Yt={dimensions:{xRadius:1,yRadius:1},orientation:$.POINTY,origin:{x:0,y:0},offset:-1},qr=(n,t,e,i)=>[{x:e+.5*n,y:i-.25*t},{x:e+.5*n,y:i+.25*t},{x:e,y:i+.5*t},{x:e-.5*n,y:i+.25*t},{x:e-.5*n,y:i-.25*t},{x:e,y:i-.5*t}],Pr=(n,t,e,i)=>[{x:e+.25*n,y:i-.5*t},{x:e+.5*n,y:i},{x:e+.25*n,y:i+.5*t},{x:e-.25*n,y:i+.5*t},{x:e-.5*n,y:i},{x:e-.25*n,y:i-.5*t}];function si(n){const{dimensions:t,orientation:e,origin:i,offset:s}={...Yt,...n};return class extends Ve{get dimensions(){return function Nr(n,t){if(Zt(n)&&n.xRadius>0&&n.yRadius>0)return n;if(Zt(n)&&n.width>0&&n.height>0){const{width:e,height:i}=n;return t===$.POINTY?{xRadius:e/Math.sqrt(3),yRadius:i/2}:{xRadius:e/2,yRadius:i/Math.sqrt(3)}}if(n>0)return{xRadius:n,yRadius:n};throw new TypeError(`Invalid dimensions: ${JSON.stringify(n)}. Dimensions must be expressed as an Ellipse ({ xRadius: number, yRadius: number }), a Rectangle ({ width: number, height: number }) or a number.`)}(t,e)}get orientation(){return e}get origin(){return function Dr(n,t){if((n=>Zt(n)&&H(n.x)&&H(n.y))(n))return n;if(!t)throw new TypeError(`Supply a bounding box ({ width: number, height: number }). Received: ${JSON.stringify(t)}`);if("topLeft"===n)return{x:-.5*t.width,y:-.5*t.height};throw new TypeError(`Invalid origin: ${JSON.stringify(n)}. Origin must be expressed as a Point ({ x: number, y: number }) or the string 'topLeft'.`)}(i,this)}get offset(){return s}}}const Ke=({q:n,r:t,offset:e,isPointy:i})=>i?((n,t,e)=>({col:n+fe(e,t),row:t}))(n,t,e):((n,t,e)=>({col:n,row:t+fe(e,n)}))(n,t,e),tn=({orientation:n,dimensions:{xRadius:t,yRadius:e},origin:{x:i,y:s},q:r,r:a})=>n===$.POINTY?{x:t*Math.sqrt(3)*(r+a/2)-i,y:3*e/2*a-s}:{x:3*t/2*r-i,y:e*Math.sqrt(3)*(a+r/2)-s},ri=(n,t,e)=>{const i=n-fe(e,t);return{q:i,r:t,s:-i-t}},oi=(n,t,e)=>{const i=n,s=t-fe(e,n);return{q:i,r:s,s:-i-s}},ai=({offset:n,orientation:t},{col:e,row:i})=>t===$.POINTY?ri(e,i,n):oi(e,i,n),en=n=>{const{q:t,r:e,s:i}=Lt(n);let s=Math.round(t),r=Math.round(e),a=Math.round(i);const h=Math.abs(t-s),u=Math.abs(e-r),c=Math.abs(i-a);return h>u&&h>c?s=-r-a:u>c?r=-s-a:a=-s-r,{q:s,r,s:a}};function jt(n,t){return le(t)?de(t):zt(t)?ai(n,t):Lt(t)}function pe(n,t,e){const{q:i,r:s,s:r}=jt(n,t),{q:a,r:h,s:u}=jt(n,e);return Math.max(Math.abs(i-a),Math.abs(s-h),Math.abs(r-u))}var z=(n=>(n[n.N=0]="N",n[n.NE=1]="NE",n[n.E=2]="E",n[n.SE=3]="SE",n[n.S=4]="S",n[n.SW=5]="SW",n[n.W=6]="W",n[n.NW=7]="NW",n))(z||{});const jr=[null,{q:1,r:-1},{q:1,r:0},{q:0,r:1},null,{q:-1,r:1},{q:-1,r:0},{q:0,r:-1}],Hr=[{q:0,r:-1},{q:1,r:-1},null,{q:1,r:0},{q:0,r:1},{q:-1,r:1},null,{q:-1,r:0}],me=(n,t)=>n.clone(n.isPointy?(({offset:n,q:t,r:e,col:i,row:s},r)=>{if(r===z.S||r===z.N)return ri(i,r===z.S?s+1:s-1,n);const a=jr[r];return{q:t+a.q,r:e+a.r}})(n,t):(({offset:n,q:t,r:e,col:i,row:s},r)=>{if(r===z.E||r===z.W)return oi(r===z.E?i+1:i-1,s,n);const a=Hr[r];return{q:t+a.q,r:e+a.r}})(n,t));function Ht(n){return Array.isArray(n)?function(t,e){const i=[];let s=e;for(const r of n)for(const a of r(t,s))i.push(s=a);return i}:n}function sn(n){return function Fr(n){return n.direction in z}(n)?function $r({start:n,direction:t,length:e}){return function(i,s){const r=[];let a=i(n??s);!n&&s&&(a=me(a,t));for(let h=0;h<e;h++)r.push(a),a=me(a,t);return r}}(n):function Jr({start:n,stop:t}){return function(e,i){const s=[],r=e(n??i),u=function Xr(n,t){return e=>({q:n.q*(1-e)+t.q*e,r:n.r*(1-e)+t.r*e})}(hi(r),hi(jt(r,t))),c=pe(r,r,t),l=1/Math.max(c,1);let f=!n&&i?1:0;for(;f<=c;f++){const g=en(u(l*f));s.push(e(g))}return s}}(n)}function hi({q:n,r:t,s:e}){return{q:n+1e-6,r:t+1e-6,s:e+-2e-6}}function ci(n,t){return function(e,i){const{width:s,height:r,start:a,direction:h=z.E}=t?function Qr(n,t,{isPointy:e,offset:i}){const{col:s,row:r}=li(n,e,i),{col:a,row:h}=li(t,e,i),l=(s<a?"A":"B")+(r<h?"A":"B"),{swapWidthHeight:f,direction:g}=Wr[l],b=Math.abs(s-a)+1,C=Math.abs(r-h)+1;return{width:f?C:b,height:f?b:C,start:n,direction:g}}(n,t,e()):n,u=a??i??[0,0],c=function ui(n,t,{includeSource:e=!0}={}){return function(i,s){const r=[];for(const a of Ht(n)(i,s)){e&&r.push(a);for(const h of Ht(t)(i,a))r.push(h)}return r}}(sn({start:u,direction:Sr(h,2),length:r}),sn({direction:h,length:s-1}))(e,u);return!a&&i?c.slice(1):c}}function li(n,t,e){if(zt(n))return n;const{q:i,r:s}=le(n)?de(n):Lt(n);return Ke({q:i,r:s,isPointy:t,offset:e})}const Wr={AA:{swapWidthHeight:!1,direction:z.E},AB:{swapWidthHeight:!0,direction:z.N},BA:{swapWidthHeight:!0,direction:z.S},BB:{swapWidthHeight:!1,direction:z.W}},nt=class{constructor(t,e=[]){if(pt(this,ft),pt(this,Ut),pt(this,Ft),pt(this,$t),pt(this,B,void 0),pt(this,et,new Map),t instanceof nt)return un(this,B,j(t,B)),void this.setHexes(t);un(this,B,t),this.setHexes(X(this,Ut,cn).call(this,e))}static fromIterable(t){const e=t[Symbol.iterator]().next().value;if(!e)throw new TypeError(`Can't create grid from empty iterable: ${JSON.stringify(t)}`);return new nt(e.constructor,t)}static fromJSON({hexSettings:t,coordinates:e}){const i=si(t);return new nt(i,e.map(s=>new i(s)))}get size(){return j(this,et).size}get pixelWidth(){if(0===this.size)return 0;const{isPointy:t,width:e}=this.hexPrototype,i=this.toArray(),{0:s,length:r,[r-1]:a}=i.sort(t?(h,u)=>u.s-h.s||h.q-u.q:(h,u)=>h.q-u.q);return a.x-s.x+e}get pixelHeight(){if(0===this.size)return 0;const{isPointy:t,height:e}=this.hexPrototype,i=this.toArray(),{0:s,length:r,[r-1]:a}=i.sort(t?(h,u)=>h.r-u.r:(h,u)=>u.s-h.s||h.r-u.r);return a.y-s.y+e}[Symbol.iterator](){return j(this,et).values()}get hexPrototype(){return j(this,B).prototype}createHex(t){return new(j(this,B))(t)}getHex(t){const e=this.createHex(t);return j(this,et).get(e.toString())}hasHex(t){return j(this,et).has(t.toString())}setHexes(t){for(const e of t){const i=e instanceof Ve?e:new(j(this,B))(e);X(this,ft,Jt).call(this,i)}return this}filter(t){var i;const e=new nt(j(this,B));for(const s of this)t(s)&&X(i=e,ft,Jt).call(i,s);return e}map(t){var i;const e=new nt(j(this,B));for(const s of this)X(i=e,ft,Jt).call(i,t(s));return e}traverse(t,{bail:e=!1}={}){var s;const i=new nt(j(this,B));for(const r of X(this,Ut,cn).call(this,t)){const a=this.getHex(r);if(a)X(s=i,ft,Jt).call(s,a);else if(e)return i}return i}forEach(t){for(const e of this)t(e);return this}reduce(t,e){if(void 0===e){let s,r,a;for(const h of this)r=a,a=h,r&&(s=t(r,a));return s}let i=e;for(const s of this)i=t(i,s);return i}toArray(){return Array.from(this)}toJSON(){const{dimensions:t,orientation:e,origin:i,offset:s}=this.hexPrototype;return{hexSettings:{dimensions:t,orientation:e,origin:i,offset:s},coordinates:this.toArray()}}toString(){return`${this.constructor.name}(${this.size})`}pointToHex(t,{allowOutside:e=!0}={}){const i=(({dimensions:{xRadius:n,yRadius:t},origin:e,orientation:i},{x:s,y:r})=>(s+=e.x,r+=e.y,en(i===$.POINTY?{q:Math.sqrt(3)*s/(3*n)-r/(3*t),r:2/3*(r/t)}:{q:2/3*(s/n),r:Math.sqrt(3)*r/(3*t)-s/(3*n)})))(this.hexPrototype,t),s=this.getHex(i);return e?s??this.createHex(i):s}distance(t,e,{allowOutside:i=!0}={}){if(i)return pe(this.hexPrototype,t,e);const s=this.getHex(t),r=this.getHex(e);return s&&r?pe(this.hexPrototype,s,r):void 0}neighborOf(t,e,{allowOutside:i=!0}={}){const s=me(this.createHex(t),e),r=this.getHex(s);return i?r??s:r}};let Bt=nt;B=new WeakMap,et=new WeakMap,ft=new WeakSet,Jt=function(t){j(this,et).set(t.toString(),t)},Ut=new WeakSet,cn=function(t){return X(this,Ft,ln).call(this,t)?X(this,$t,fn).call(this,t):Array.isArray(t)&&X(this,Ft,ln).call(this,t[0])?X(this,$t,fn).call(this,Ht(t)):t},Ft=new WeakSet,ln=function(t){return"function"==typeof t},$t=new WeakSet,fn=function(t){return t(this.createHex.bind(this))};const Vr=["map"],Kr=function(n,t,e,i){return{"width.px":n,"height.px":t,"background-image":e,"background-size":i}},rn=si({dimensions:30,origin:"topLeft"}),J=new Bt(rn,ci({width:1,height:1})).toArray()[0];let to=(()=>{class n{constructor(e){this.router=e,this.grid=new Bt(rn),this.mapWidth=0,this.mapHeight=0,this.didInit=!1}ngOnChanges(e){if(e.mapData){const i=e.mapData;this.changeShouldRecreateGrid(i.currentValue,i.previousValue)?this.updateMapGrid():this.changeShouldRenderGrid(i.currentValue,i.previousValue)&&this.renderGrid()}}ngAfterViewInit(){this.setupSvg(),this.renderGrid(),this.didInit=!0}changeShouldRecreateGrid(e,i){return!i||e.gridColumns!==i.gridColumns||e.gridRows!==i.gridRows||e.gridOffsetX!==i.gridOffsetX||e.gridOffsetY!==i.gridOffsetY}changeShouldRenderGrid(e,i){return this.didInit&&(!i||e.backgroundImage!==i.backgroundImage)}updateMapGrid(){this.grid=new Bt(rn,ci({width:this.mapData.gridColumns,height:this.mapData.gridRows,start:{col:this.mapData.gridOffsetX,row:this.mapData.gridOffsetY}})),this.mapWidth=this.grid.pixelWidth,this.mapHeight=this.grid.pixelHeight,this.didInit&&this.renderGrid()}setupSvg(){this.svg=Ar().addTo(this.mapRef.nativeElement).size("100%","100%"),this.svgHexBorder=this.svg.defs().polygon(J.corners.map(({x:e,y:i})=>`${e},${i}`).join(" ")).id("svgHexBorder").fill("none").stroke({width:1,color:"#333"})}renderGrid(){this.svg.children().forEach(i=>{i instanceof ne||i.remove()});const e=this.svg.rect(this.mapWidth,this.mapHeight).fill("none").stroke({width:2,color:"#333"});this.svg.add(e),this.grid.forEach(i=>{const s=tn(i);s.x-=J.width*this.mapData.gridOffsetX,s.y-=.75*J.height*this.mapData.gridOffsetY,1===this.mapData.gridRows&&Math.abs(this.mapData.gridOffsetY)%2==1&&(s.x-=.5*J.width);const r=this.svg.nested().id(`map_${i.q}_${i.r}`).size(J.width,J.height).x(s.x-i.width/2).y(s.y-i.height/2);r.use(this.svgHexBorder);const a=this.svg.text(`${i.col},${i.row}`).center(J.width/2,J.height/2).font({fill:"#555"});r.add(a)})}onClickGrid(e){const i=this.mapRef.nativeElement.getBoundingClientRect();let s=e.clientX-i.left+J.width*this.mapData.gridOffsetX;const r=e.clientY-i.top+.75*J.height*this.mapData.gridOffsetY;1===this.mapData.gridRows&&Math.abs(this.mapData.gridOffsetY)%2==1&&(s+=.5*J.width);const a=this.grid.pointToHex({x:s,y:r},{allowOutside:!1});a&&this.router.navigate(["maps",this.mapEntry.id,`${a.col}_${a.row}`])}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(gt.F0))},n.\u0275cmp=o.Xpm({type:n,selectors:[["lxs-map-display"]],viewQuery:function(e,i){if(1&e&&o.Gf(Vr,5),2&e){let s;o.iGM(s=o.CRH())&&(i.mapRef=s.first)}},inputs:{mapEntry:"mapEntry",mapData:"mapData"},features:[o.TTD],decls:3,vars:6,consts:[[1,"container"],[1,"map",3,"ngStyle","click"],["map",""]],template:function(e,i){1&e&&(o.TgZ(0,"div",0)(1,"div",1,2),o.NdJ("click",function(r){return i.onClickGrid(r)}),o.qZA()()),2&e&&(o.xp6(1),o.Q6J("ngStyle",o.l5B(1,Kr,i.mapWidth,i.mapHeight,i.mapData.backgroundImage?"url('"+i.mapData.backgroundImage+"')":void 0,i.mapData.backgroundImage?"100% 100%":void 0)))},dependencies:[rt.PC],styles:[".container[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}.map[_ngcontent-%COMP%]{margin:auto}"]}),n})();var eo=p(6047),no=p(6319),di=p(5549),io=p(7392),pi=p(8810),mi=p(93);function so(n,t){if(1&n&&(o.ynx(0),o.TgZ(1,"label",21),o._uU(2," Rename: "),o._UZ(3,"input",22),o.qZA(),o.BQk()),2&n){const e=o.oxw();o.xp6(3),o.Q6J("formControl",e.renamingControl)}}function ro(n,t){if(1&n&&o._uU(0),2&n){const e=o.oxw();o.Oqu(e.mapEntry.name)}}function oo(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"img",23),o.NdJ("load",function(){o.CHM(e);const s=o.oxw();return o.KtG(s.onCheckImageLoadSuccess())})("error",function(){o.CHM(e);const s=o.oxw();return o.KtG(s.onCheckImageLoadError())}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("src",e.imageCheckUrl,o.LSH)}}function ao(n,t){if(1&n&&(o.TgZ(0,"p"),o._uU(1),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.Oqu(e.imageCheckStatus)}}const ho=function(n,t){return[n,t]},uo=function(n){return[n]};let co=(()=>{class n{constructor(e,i,s){this.dialog=e,this.linker=i,this.maps=s,this.clickBack=new o.vpe,this.isRenaming=!1,this.renamingControl=new mt.p4(""),this.backgroundImageControl=new mt.p4(""),this.subscriptions=new we.w0,this.backAction={icon:"back",action:()=>{this.clickBack.emit()}},this.renameAction={icon:"quill",action:()=>{this.isRenaming=!0}},this.renameCancelAction={icon:"close",action:()=>{this.isRenaming=!1,this.renamingControl.setValue(this.mapEntry.name)}},this.renameSaveAction={icon:"check",action:()=>{this.isRenaming=!1,this.maps.editMapEntry(this.mapEntry.id,r=>(r.name=this.renamingControl.value,r))}}}ngOnChanges(e){e.mapEntry&&(this.isRenaming||this.renamingControl.setValue(this.mapEntry.name)),e.mapData&&this.backgroundImageControl.setValue(this.mapData.backgroundImage)}onMapNoteChanged(e){this.mapData.note=e,this.maps.updateMapData(this.mapEntry.id,this.mapData)}onAdd(e){let i,s;switch(e){case"left":case"right":i="gridColumns","left"===e&&(s="gridOffsetX");break;case"top":case"bottom":i="gridRows","top"===e&&(s="gridOffsetY")}const r={...this.mapData};r[i]+=1,s&&(r[s]-=1),this.maps.updateMapData(this.mapEntry.id,r)}onRemove(e){let i,s;switch(e){case"left":case"right":i="gridColumns","left"===e&&(s="gridOffsetX");break;case"top":case"bottom":i="gridRows","top"===e&&(s="gridOffsetY")}if(this.mapData[i]<=1)return;let r=!1;const a="gridColumns"===i?this.mapData.gridOffsetY:this.mapData.gridOffsetX,h=a+("gridColumns"===i?this.mapData.gridRows:this.mapData.gridColumns),u=("gridColumns"===i?this.mapData.gridOffsetX:this.mapData.gridOffsetY)+("right"===e||"bottom"===e?this.mapData[i]-1:0);for(let l=a;l<h;l++)if(this.mapData.tiles[`${"gridColumns"===i?u:l}_${"gridColumns"===i?l:u}`]){r=!0;break}const c=()=>{const l={...this.mapData,tiles:{...this.mapData.tiles}};l[i]-=1,s&&(l[s]+=1);for(let f=a;f<h;f++)delete l.tiles[`${"gridColumns"===i?u:f}_${"gridColumns"===i?f:u}`];this.maps.updateMapData(this.mapEntry.id,l)};r?this.subscriptions.add(this.dialog.open(eo.$,{data:{message:"Are you sure you want to delete these tiles?"}}).afterClosed().subscribe(l=>{l&&c()})):c()}onClickCheckImage(){const e=this.backgroundImageControl.value;this.imageCheckUrl=e,this.imageCheckStatus=void 0,e||(this.mapData.backgroundImage=void 0,this.maps.updateMapData(this.mapEntry.id,this.mapData),this.imageCheckStatus="Saved successfully.")}onCheckImageLoadSuccess(){this.mapData.backgroundImage=this.imageCheckUrl,this.imageCheckUrl=void 0,this.maps.updateMapData(this.mapEntry.id,this.mapData),this.imageCheckStatus="Loaded and saved successfully."}onCheckImageLoadError(){this.imageCheckUrl=void 0,this.imageCheckStatus="Unable to load image. Check the URL to make sure it can be accessed by your browser, or try a different path."}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(no.uw),o.Y36(di.I),o.Y36(Xt.Q))},n.\u0275cmp=o.Xpm({type:n,selectors:[["lxs-map-panel"]],inputs:{mapEntry:"mapEntry",mapData:"mapData"},outputs:{clickBack:"clickBack"},features:[o.TTD],decls:47,vars:16,consts:[[3,"leftAction","rightActions"],[4,"ngIf","ngIfElse"],["notRenaming",""],[1,"section-header"],["linkPreferredSource","maps",1,"note",3,"value","linkEvaluator","valueChanged"],[1,"content"],[1,"grid-options-section"],[1,"icon",3,"click"],["svgIcon","collapse"],[1,"grid-options-middle"],[1,"grid-options-left"],["svgIcon","back"],[1,"grid-options-center"],[1,"grid-options-right"],["svgIcon","forward"],["svgIcon","expand"],[1,"image-field"],["type","text","placeholder","Enter a URL to an image",3,"formControl"],["svgIcon","check"],["class","check-image",3,"src","load","error",4,"ngIf"],[4,"ngIf"],[1,"rename-field"],["type","text",3,"formControl"],[1,"check-image",3,"src","load","error"]],template:function(e,i){if(1&e&&(o.TgZ(0,"lxs-side-header",0),o.YNc(1,so,4,1,"ng-container",1),o.YNc(2,ro,1,1,"ng-template",null,2,o.W1O),o.qZA(),o.TgZ(4,"h2",3),o._uU(5,"Note"),o.qZA(),o.TgZ(6,"lxs-inscription-editor",4),o.NdJ("valueChanged",function(r){return i.onMapNoteChanged(r)}),o.qZA(),o.TgZ(7,"h2",3),o._uU(8,"Configure"),o.qZA(),o.TgZ(9,"div",5)(10,"div"),o._uU(11),o.qZA(),o.TgZ(12,"div",6)(13,"div",7),o.NdJ("click",function(){return i.onAdd("top")}),o._UZ(14,"mat-icon",8),o.qZA(),o.TgZ(15,"div",9)(16,"div",10)(17,"div",7),o.NdJ("click",function(){return i.onAdd("left")}),o._UZ(18,"mat-icon",11),o.qZA()(),o.TgZ(19,"div",12),o._uU(20," Add Tiles "),o.qZA(),o.TgZ(21,"div",13)(22,"div",7),o.NdJ("click",function(){return i.onAdd("right")}),o._UZ(23,"mat-icon",14),o.qZA()()(),o.TgZ(24,"div",7),o.NdJ("click",function(){return i.onAdd("bottom")}),o._UZ(25,"mat-icon",15),o.qZA()(),o.TgZ(26,"div",6)(27,"div",7),o.NdJ("click",function(){return i.onRemove("top")}),o._UZ(28,"mat-icon",15),o.qZA(),o.TgZ(29,"div",9)(30,"div",10)(31,"div",7),o.NdJ("click",function(){return i.onRemove("left")}),o._UZ(32,"mat-icon",14),o.qZA()(),o.TgZ(33,"div",12),o._uU(34," Remove Tiles "),o.qZA(),o.TgZ(35,"div",13)(36,"div",7),o.NdJ("click",function(){return i.onRemove("right")}),o._UZ(37,"mat-icon",11),o.qZA()()(),o.TgZ(38,"div",7),o.NdJ("click",function(){return i.onRemove("bottom")}),o._UZ(39,"mat-icon",8),o.qZA()(),o.TgZ(40,"label",16),o._uU(41," Background Image: "),o._UZ(42,"input",17),o.qZA(),o.TgZ(43,"div",7),o.NdJ("click",function(){return i.onClickCheckImage()}),o._UZ(44,"mat-icon",18),o.qZA(),o.YNc(45,oo,1,1,"img",19),o.YNc(46,ao,2,1,"p",20),o.qZA()),2&e){const s=o.MAs(3);o.Q6J("leftAction",i.isRenaming?void 0:i.backAction)("rightActions",i.isRenaming?o.WLB(11,ho,i.renameCancelAction,i.renameSaveAction):o.VKq(14,uo,i.renameAction)),o.xp6(1),o.Q6J("ngIf",i.isRenaming)("ngIfElse",s),o.xp6(5),o.Q6J("value",i.mapData.note)("linkEvaluator",i.linker),o.xp6(5),o.AsE("",i.mapData.gridColumns," Columns x ",i.mapData.gridRows," Rows"),o.xp6(31),o.Q6J("formControl",i.backgroundImageControl),o.xp6(3),o.Q6J("ngIf",i.imageCheckUrl),o.xp6(1),o.Q6J("ngIf",i.imageCheckStatus)}},dependencies:[rt.O5,io.Hw,pi.p,mt.Fj,mt.JJ,mt.oH,mi.z],styles:[".rename-field[_ngcontent-%COMP%]{display:inline-block;width:100%}.rename-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0 .5rem;max-width:calc(100% - 16px)}.section-header[_ngcontent-%COMP%]{margin:0;padding:0 .5rem}.note[_ngcontent-%COMP%]{padding-left:.5rem}.content[_ngcontent-%COMP%]{padding:0 .5rem}.content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:2rem;height:2rem;line-height:2rem;-webkit-user-select:none;user-select:none}.content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{width:1rem;height:1rem;line-height:1rem;color:#333}.content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:hover{cursor:pointer}.content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:hover > mat-icon[_ngcontent-%COMP%]{color:#555}.grid-options-section[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;align-items:center;margin:.5rem;border-top:.0625rem solid #333;padding-top:.5rem}.grid-options-middle[_ngcontent-%COMP%]{display:flex;align-items:center}.grid-options-center[_ngcontent-%COMP%]{flex:1}.grid-options-left[_ngcontent-%COMP%], .grid-options-right[_ngcontent-%COMP%]{flex:0}.image-field[_ngcontent-%COMP%]{display:inline-block;width:100%}.image-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 8px)}.check-image[_ngcontent-%COMP%]{width:100%}"]}),n})(),fo=(()=>{class n{constructor(e,i){this.linker=e,this.maps=i,this.clickBack=new o.vpe,this.backAction={icon:"back",action:()=>{this.clickBack.emit()}}}ngOnChanges(e){this.tileData=this.mapData.tiles[this.tileId]||(n=>({...Mi(this.tileId)}))()}onNoteChanged(e){this.tileData.note=e,this.mapData.tiles[this.tileId]=this.tileData,this.maps.updateMapData(this.mapEntry.id,this.mapData)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(di.I),o.Y36(Xt.Q))},n.\u0275cmp=o.Xpm({type:n,selectors:[["lxs-map-tile-panel"]],inputs:{mapEntry:"mapEntry",mapData:"mapData",tileId:"tileId"},outputs:{clickBack:"clickBack"},features:[o.TTD],decls:5,vars:5,consts:[[3,"leftAction"],[1,"section-header"],["linkPreferredSource","maps",1,"note",3,"value","linkEvaluator","valueChanged"]],template:function(e,i){1&e&&(o.TgZ(0,"lxs-side-header",0),o._uU(1),o.qZA(),o.TgZ(2,"h2",1),o._uU(3,"Note"),o.qZA(),o.TgZ(4,"lxs-inscription-editor",2),o.NdJ("valueChanged",function(r){return i.onNoteChanged(r)}),o.qZA()),2&e&&(o.Q6J("leftAction",i.backAction),o.xp6(1),o.AsE("Tile ",i.tileData.col,", ",i.tileData.row,""),o.xp6(3),o.Q6J("value",i.tileData.note)("linkEvaluator",i.linker))},dependencies:[pi.p,mi.z],styles:[".section-header[_ngcontent-%COMP%]{margin:0;padding:0 .5rem}.note[_ngcontent-%COMP%]{padding-left:.5rem}"]}),n})();const po=function(){return["notes","help"]};let mo=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["lxs-maps-help"]],decls:22,vars:3,consts:[[3,"routerLink","relativeTo"]],template:function(e,i){1&e&&(o.TgZ(0,"h1"),o._uU(1,"Maps Tool"),o.qZA(),o.TgZ(2,"p"),o._uU(3," Use the Maps Tool to plan locations and regions in a world!\n"),o.qZA(),o.TgZ(4,"p"),o._uU(5," Click the plus button on the left bar to create a new map. The editor visualizes the map as a hex grid. In the map's details panel, use edit button in the header bar to rename the map, and use the Note section to describe the map. Map notes support the same markdown as the Notes Tool, more details can be found "),o.TgZ(6,"a",0),o._uU(7,"here"),o.qZA(),o._uU(8,". The configure section adjusts the map, by adding or removing rows and columns and by setting a background image for the entire map.\n"),o.qZA(),o.TgZ(9,"p"),o._uU(10," Click anywhere in the grid of the map to select that tile. Each tile supports adding its own notes as well, along with the same markdown. However, tiles cannot be linked to from other notes.\n"),o.qZA(),o.TgZ(11,"p"),o._uU(12," Some sample ideas for using this tool:\n"),o.qZA(),o.TgZ(13,"ul")(14,"li"),o._uU(15,' Prepare for a "hex crawl" by loading a world map as a background image, then fill the notes for the different tiles with descriptions of terrain or climate, or with different locations, dungeons, and random encounters that may be visited. '),o.qZA(),o.TgZ(16,"li"),o._uU(17," Plan a dungeon encounter by loading a dungeon map as a background image, use the map's notes to describe the dungeon, rooms, and random or time-based encounters, and use the tile's notes to describe doors, traps, monsters, treasure, or anything else that fills the tile. "),o.qZA(),o.TgZ(18,"li"),o._uU(19," Utilize the 2D graph for relational or positional note-taking. Your imagination is the limit! "),o.qZA()(),o.TgZ(20,"p"),o._uU(21," Open this page again by the question mark button on the left bar.\n"),o.qZA()),2&e&&(o.xp6(6),o.Q6J("routerLink",o.DdM(2,po))("relativeTo",null))},dependencies:[gt.yS]}),n})();var go=p(7579),yo=p(9130);let wo=(()=>{class n{constructor(e,i,s){this.router=e,this.settings=i,this.maps=s,this.selectedActiveEntry=new o.vpe,this.subscriptions=new we.w0,this.addEvent=new go.x}ngOnInit(){this.subscriptions.add(this.maps.mapEntriesList.subscribe(e=>{this.mapEntries=e})),this.subscriptions.add(this.addEvent.subscribe(()=>{const e=this.maps.addMapEntry();this.settings.setSetting("mapsSelectedId",e),this.router.navigate(["maps",e])}))}ngOnDestroy(){this.subscriptions.unsubscribe()}onSelect(e){e!==this.activeEntryId?(this.settings.setSetting("mapsSelectedId",e),this.router.navigate(["maps",e])):this.selectedActiveEntry.emit()}onMove(e){this.maps.moveMapEntry(e.from,e.to)}onClickAbout(){this.settings.setSetting("mapsSelectedId",null),this.router.navigate(["maps"])}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(gt.F0),o.Y36(gn.g),o.Y36(Xt.Q))},n.\u0275cmp=o.Xpm({type:n,selectors:[["lxs-maps-list"]],inputs:{activeEntryId:"activeEntryId"},outputs:{selectedActiveEntry:"selectedActiveEntry"},decls:1,vars:3,consts:[["label","Maps",3,"entries","selectedEntryId","showHelp","addEvent","selectEvent","moveEvent","helpEvent"]],template:function(e,i){1&e&&(o.TgZ(0,"lxs-side-listing",0),o.NdJ("addEvent",function(){return i.addEvent.next()})("selectEvent",function(r){return i.onSelect(r)})("moveEvent",function(r){return i.onMove(r)})("helpEvent",function(){return i.onClickAbout()}),o.qZA()),2&e&&o.Q6J("entries",i.mapEntries)("selectedEntryId",i.activeEntryId)("showHelp",!0)},dependencies:[yo.f]}),n})();function _o(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"lxs-maps-list",6),o.NdJ("selectedActiveEntry",function(){o.CHM(e);const s=o.oxw();return o.KtG(s.onSelectedSameMapEntry())}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("activeEntryId",null==e.state.mapEntry?null:e.state.mapEntry.id)}}function xo(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"lxs-map-panel",7),o.NdJ("clickBack",function(){o.CHM(e);const s=o.oxw();return o.KtG(s.onBackFromMap())}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("mapEntry",e.state.mapEntry)("mapData",e.state.mapData)}}function bo(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"lxs-map-tile-panel",8),o.NdJ("clickBack",function(){o.CHM(e);const s=o.oxw();return o.KtG(s.onBackFromTile())}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("mapEntry",e.state.mapEntry)("mapData",e.state.mapData)("tileId",e.state.tileId)}}function vo(n,t){1&n&&o._UZ(0,"lxs-maps-help")}function Co(n,t){if(1&n&&o._UZ(0,"lxs-map-display",9),2&n){const e=o.oxw();o.Q6J("mapEntry",e.state.mapEntry)("mapData",e.state.mapData)}}let on=(()=>{class n{constructor(e,i,s,r){this.route=e,this.router=i,this.settings=s,this.maps=r,this.subscriptions=new we.w0,this.state={state:"list",view:"list"}}ngOnInit(){this.subscriptions.add(this.route.paramMap.pipe((0,dn.w)(e=>{const i=e.get("id"),s=e.get("tileId");return i?(0,vi.a)([(0,pn.of)(i),(0,pn.of)(s),this.maps.getMapEntry(i),this.maps.getMapData(i)]):(this.state={state:"list",view:"list"},this.redirectToRecent())})).subscribe(([e,i,s,r])=>{s?i?(n=>{const t=n.split("_");return 2===t.length&&Number.isInteger(Number(t[0]))&&Number.isInteger(Number(t[1]))})(i)?this.state={state:"map",view:"tile",mapEntry:s,mapData:r,tileId:i}:this.router.navigate(["maps-tile-not-found",e,i]):this.state={state:"map",view:"map",mapEntry:s,mapData:r}:this.router.navigate(["maps-not-found",e])}))}redirectToRecent(){const e=this.settings.getCurrentSetting("mapsSelectedId");return e?this.maps.getMapEntry(e).pipe((0,dn.w)(i=>(i&&this.router.navigate(["maps",e]),mn.C))):mn.C}onBackFromMap(){this.state.view="list"}onBackFromTile(){this.router.navigate(["maps",this.state.mapEntry?.id])}onSelectedSameMapEntry(){"map"===this.state.state&&(this.state.view="map")}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(gt.gz),o.Y36(gt.F0),o.Y36(gn.g),o.Y36(Xt.Q))},n.\u0275cmp=o.Xpm({type:n,selectors:[["lxs-maps"]],decls:7,vars:5,consts:[["side",""],[3,"activeEntryId","selectedActiveEntry",4,"ngIf"],[3,"mapEntry","mapData","clickBack",4,"ngIf"],[3,"mapEntry","mapData","tileId","clickBack",4,"ngIf"],[4,"ngIf"],[3,"mapEntry","mapData",4,"ngIf"],[3,"activeEntryId","selectedActiveEntry"],[3,"mapEntry","mapData","clickBack"],[3,"mapEntry","mapData","tileId","clickBack"],[3,"mapEntry","mapData"]],template:function(e,i){1&e&&(o.TgZ(0,"lxs-split-panels"),o.ynx(1,0),o.YNc(2,_o,1,1,"lxs-maps-list",1),o.YNc(3,xo,1,2,"lxs-map-panel",2),o.YNc(4,bo,1,3,"lxs-map-tile-panel",3),o.BQk(),o.YNc(5,vo,1,0,"lxs-maps-help",4),o.YNc(6,Co,1,2,"lxs-map-display",5),o.qZA()),2&e&&(o.xp6(2),o.Q6J("ngIf","list"===i.state.view),o.xp6(1),o.Q6J("ngIf","map"===i.state.view),o.xp6(1),o.Q6J("ngIf","tile"===i.state.view),o.xp6(1),o.Q6J("ngIf","list"===i.state.state),o.xp6(1),o.Q6J("ngIf","map"===i.state.state))},dependencies:[rt.O5,Ti.f,to,co,fo,mo,wo]}),n})(),Mo=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[rt.ez,yi.D,gi.p,wi.y,mt.UX,gt.Bz.forChild([{path:"",component:on},{path:":id",component:on},{path:":id/:tileId",component:on}]),_i.o,xi.Q,bi.n]}),n})()}}]);